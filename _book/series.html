<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis comparativo del desempeño en métodos para el pronóstico de series temporales – 5&nbsp; Series de Tiempo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./redes.html" rel="next">
<link href="./procesos.html" rel="prev">
<link href="./logofcfm.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Análisis comparativo del desempeño en métodos para el pronóstico de series temporales - 5&nbsp; Series de Tiempo">
<meta property="og:image" content="logofcfm.png">
<meta property="og:site_name" content="Análisis comparativo del desempeño en métodos para el pronóstico de series temporales">
<meta name="twitter:title" content="Análisis comparativo del desempeño en métodos para el pronóstico de series temporales - 5&nbsp; Series de Tiempo">
<meta name="twitter:image" content="logofcfm.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./series.html">Series de tiempo</a></li><li class="breadcrumb-item"><a href="./series.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Series de Tiempo</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./LOGO50.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis comparativo del desempeño en métodos para el pronóstico de series temporales</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Jennlg/Tesis" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Tesis_JSLG.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Tesis_JSLG.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objetivos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Objetivos</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminares</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tconjuntos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Teoría de conjuntos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estadistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estadística</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./procesos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Procesos estocásticos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Series de tiempo</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./series.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Series de Tiempo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Redes neuronales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./redes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Redes Neuronales</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./estudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estudio de caso</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confirmados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pronóstico de infectados diarios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./muertes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pronóstico de decesos diarios</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conclusiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#conceptos-básicos-y-manipulación-de-series-de-tiempo" id="toc-conceptos-básicos-y-manipulación-de-series-de-tiempo" class="nav-link active" data-scroll-target="#conceptos-básicos-y-manipulación-de-series-de-tiempo"><span class="header-section-number">5.1</span> Conceptos básicos y manipulación de series de tiempo</a>
  <ul class="collapse">
  <li><a href="#series-de-tiempo-estacionarias" id="toc-series-de-tiempo-estacionarias" class="nav-link" data-scroll-target="#series-de-tiempo-estacionarias"><span class="header-section-number">5.1.1</span> Series de tiempo estacionarias</a></li>
  <li><a href="#conjuntos-de-datos-de-series-temporales." id="toc-conjuntos-de-datos-de-series-temporales." class="nav-link" data-scroll-target="#conjuntos-de-datos-de-series-temporales."><span class="header-section-number">5.1.2</span> Conjuntos de datos de series temporales.</a></li>
  <li><a href="#suavizado-de-datos-de-series-temporales." id="toc-suavizado-de-datos-de-series-temporales." class="nav-link" data-scroll-target="#suavizado-de-datos-de-series-temporales."><span class="header-section-number">5.1.3</span> Suavizado de datos de series temporales.</a></li>
  </ul></li>
  <li><a href="#análisis-y-técnicas-de-descomposición." id="toc-análisis-y-técnicas-de-descomposición." class="nav-link" data-scroll-target="#análisis-y-técnicas-de-descomposición."><span class="header-section-number">5.2</span> Análisis y técnicas de descomposición.</a>
  <ul class="collapse">
  <li><a href="#descomposición-de-datos-estacionales" id="toc-descomposición-de-datos-estacionales" class="nav-link" data-scroll-target="#descomposición-de-datos-estacionales"><span class="header-section-number">5.2.1</span> Descomposición de datos estacionales</a></li>
  <li><a href="#ajuste-estacional" id="toc-ajuste-estacional" class="nav-link" data-scroll-target="#ajuste-estacional"><span class="header-section-number">5.2.2</span> Ajuste estacional</a></li>
  </ul></li>
  <li><a href="#pronóstico-y-métodos-predictivos." id="toc-pronóstico-y-métodos-predictivos." class="nav-link" data-scroll-target="#pronóstico-y-métodos-predictivos."><span class="header-section-number">5.3</span> Pronóstico y métodos predictivos.</a>
  <ul class="collapse">
  <li><a href="#suavizador-de-media-móvil-predictivo" id="toc-suavizador-de-media-móvil-predictivo" class="nav-link" data-scroll-target="#suavizador-de-media-móvil-predictivo"><span class="header-section-number">5.3.1</span> Suavizador de media móvil predictivo</a></li>
  <li><a href="#suavizado-exponencial" id="toc-suavizado-exponencial" class="nav-link" data-scroll-target="#suavizado-exponencial"><span class="header-section-number">5.3.2</span> Suavizado exponencial</a></li>
  <li><a href="#pronóstico-holt-winters" id="toc-pronóstico-holt-winters" class="nav-link" data-scroll-target="#pronóstico-holt-winters"><span class="header-section-number">5.3.3</span> Pronóstico Holt-Winters</a></li>
  <li><a href="#modelo-autoregresivo-ar" id="toc-modelo-autoregresivo-ar" class="nav-link" data-scroll-target="#modelo-autoregresivo-ar"><span class="header-section-number">5.3.4</span> Modelo Autoregresivo (AR)</a></li>
  </ul></li>
  <li><a href="#evaluación-de-la-precisión-de-los-pronósticos" id="toc-evaluación-de-la-precisión-de-los-pronósticos" class="nav-link" data-scroll-target="#evaluación-de-la-precisión-de-los-pronósticos"><span class="header-section-number">5.4</span> Evaluación de la precisión de los pronósticos</a>
  <ul class="collapse">
  <li><a href="#mae" id="toc-mae" class="nav-link" data-scroll-target="#mae"><span class="header-section-number">5.4.1</span> MAE</a></li>
  <li><a href="#mse" id="toc-mse" class="nav-link" data-scroll-target="#mse"><span class="header-section-number">5.4.2</span> MSE</a></li>
  <li><a href="#rmse" id="toc-rmse" class="nav-link" data-scroll-target="#rmse"><span class="header-section-number">5.4.3</span> RMSE</a></li>
  <li><a href="#mape" id="toc-mape" class="nav-link" data-scroll-target="#mape"><span class="header-section-number">5.4.4</span> MAPE</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Jennlg/Tesis/edit/main/series.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Jennlg/Tesis/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/Jennlg/Tesis/blob/main/series.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./series.html">Series de tiempo</a></li><li class="breadcrumb-item"><a href="./series.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Series de Tiempo</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Series de Tiempo</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div style="text-align: justify">
<p>Las series temporales tienen su origen en la necesidad de comprender y predecir patrones presentes en datos secuenciales en el transcurso del tiempo. A lo largo de la historia, diversas civilizaciones han registrado observaciones cronológicas con el propósito de anticipar fenómenos naturales, eventos económicos y otros procesos cambiantes.</p>
<p>No obstante, el enfoque más sistemático en el análisis de series temporales se inició en el ámbito de la estadística y la econometría durante el siglo XX. Figuras pioneras como Norbert Wiener y Andrey Kolmogorov establecieron los cimientos teóricos en torno a los procesos estocásticos (<span class="citation" data-cites="wiener1949extrapolation">Wiener (<a href="references.html#ref-wiener1949extrapolation" role="doc-biblioref">1949</a>)</span>).</p>
<p>La relevancia de las series temporales en la predicción de datos radica en su habilidad para capturar patrones temporales y tendencias presentes en conjuntos de datos. A medida que se acumulan datos a lo largo del tiempo, es posible identificar relaciones y ciclos que facilitan la realización de pronósticos futuros. Esto resulta especialmente valioso en campos como la economía, la meteorología, la epidemiología y las finanzas, donde comprender los patrones temporales es crucial para tomar decisiones informadas.</p>
<p>En la actualidad, con el advenimiento de la computación y las técnicas de análisis más avanzadas, las series temporales han adquirido una importancia aún mayor. Modelos matemáticos y estadísticos avanzados, como los modelos ARIMA (Media Móvil Integrada Autoregresiva) y las redes neuronales recurrentes, permiten analizar y predecir series temporales con mayor precisión y complejidad. Estos modelos son esenciales para la toma de decisiones estratégicas en diversas industrias, ya que ayudan a anticipar tendencias, identificar patrones estacionales y enfrentar la incertidumbre en el futuro.</p>
<p>En términos generales, una serie temporal puede considerarse como una recopilación de observaciones realizadas secuencialmente en el tiempo. El interés de este análisis no recae en las series que son deterministas, sino en aquellas cuyos valores se comportan siguiendo las leyes de la probabilidad. Se discutirán los principios fundamentales involucrados en el análisis estadístico de series temporales. Para comenzar, se debe prestar una atención más meticulosa a la definición de serie temporal, dado que en realidad es un tipo particular de proceso estocástico.</p>
</div>
<section id="conceptos-básicos-y-manipulación-de-series-de-tiempo" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="conceptos-básicos-y-manipulación-de-series-de-tiempo"><span class="header-section-number">5.1</span> Conceptos básicos y manipulación de series de tiempo</h2>
<div id="def-ts" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.1 (Serie de tiempo)</strong></span> Un proceso estocástico <span class="math inline">\(X(t); t\in T\)</span> se define como una colección de variables aleatorias, donde <span class="math inline">\(T\)</span> es un conjunto de índices para el cual todas las variables aleatorias, <span class="math inline">\(X(t)\)</span>, donde <span class="math inline">\(t\)</span> pertenece a <span class="math inline">\(T\)</span>, están definidas en el mismo espacio muestral. Cuando <span class="math inline">\(T\)</span> representa el tiempo, se hace referencia al proceso estocástico como una <em>serie de tiempo</em>.</p>
</div>
<div style="text-align: justify">
<p>Si <span class="math inline">\(T\)</span> toma un rango continuo de valores (por ejemplo, <span class="math inline">\(T=(-\infty,\infty)\)</span> o <span class="math inline">\(T=(0,\infty)\)</span>) , el proceso se dice que es un <em>proceso de parámetro continuo</em>. Si, por otro lado, <span class="math inline">\(T\)</span> toma un conjunto discreto de valores (por ejemplo, <span class="math inline">\(T = \{0, 1, 2,\ldots\}\)</span> o <span class="math inline">\(T = \{0, \pm 1, \pm 2,\ldots \}\)</span>), el proceso se dice que es un <em>proceso de parámetro discreto</em>. De hecho, es común referirse a estos como <a href="./procesos.html#proceso estocástico de tiempo discreto">procesos continuos</a> y <a href="./procesos.html#proceso estocástico de tiempo continuo">discretos</a>, respectivamente.</p>
<p>Se utilizará la notación de subíndice, <span class="math inline">\(X_t\)</span>, cuando se esté tratando específicamente con un proceso de parámetro discreto. Sin embargo, cuando el proceso involucrado sea de parámetro continuo o de tipo no especificado, se utilizará la notación de función, <span class="math inline">\(X(t)\)</span>. Además, cuando no haya confusión, a menudo se utiliza la notación <span class="math inline">\(\{X(t)\}\)</span> o simplemente <span class="math inline">\(X(t)\)</span> para denotar una serie de tiempo. De manera similar, a menudo se acortará <span class="math inline">\(\{X_t;t=0,\pm 1,\ldots \}\)</span> a <span class="math inline">\(X_t,t=\{0,\pm 1,\ldots\}\)</span> o simplemente se usará <span class="math inline">\(X_t\)</span>.</p>
<p>Nótese que una variable aleatoria, <span class="math inline">\(\gamma\)</span> , es una función definida en un espacio muestral <span class="math inline">\(\Omega\)</span> cuyo rango son los números reales. Un valor observado de la variable aleatoria <span class="math inline">\(\gamma\)</span> es un número real <span class="math inline">\(y=\gamma(\omega)\)</span> para algún <span class="math inline">\(\omega\in\Omega\)</span>. Para una serie de tiempo <span class="math inline">\(\{X(t)\}\)</span>, su “valor” <span class="math inline">\(\{X(t,\omega);t\in T\}\)</span> para algún <span class="math inline">\(\omega\in\Omega\)</span> fijo es una colección de números reales. Esto lleva a la siguiente definición.</p>
</div>
<div id="def-realizacion" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.2 (Realización)</strong></span> Una <em>realización</em> de la serie de tiempo <span class="math inline">\(\{X(t);t\in T\}\)</span> es el conjunto de resultados de valores reales, <span class="math inline">\(\{X(t,\omega);t\in T\}\)</span> para un valor fijo de <span class="math inline">\(\omega \in \Omega\)</span>.</p>
</div>
<div style="text-align: justify">
<p>La colección de todas las posibles realizaciones se denomina <em>conjunto</em> y, para un valor dado de <span class="math inline">\(t\)</span>, la expectativa de la variable aleatoria <span class="math inline">\(X(t)\)</span> se denomina <em>media del conjunto</em> y se denotará como <span class="math inline">\(\mathrm E[X(t)]=\mu(t)\)</span> . La <em>varianza</em> de <span class="math inline">\(X(t)\)</span> se expresa como</p>
<p><span class="math display">\[
\mathrm{Var}[X(t)]:=\mathrm{E}[(X(t)-\mu(t))^2]
\]</span></p>
<p>y a menudo se denota como <span class="math inline">\(\sigma^2(t)\)</span> ya que también puede depender de <span class="math inline">\(t\)</span>.</p>
</div>
<div id=".remark" style="text-align: justify">
<p>De especial interés, en el análisis de una serie temporal, es la covarianza entre <span class="math inline">\(X(t_1)\)</span> y <span class="math inline">\(X(t_2)\)</span>, donde <span class="math inline">\(t_1, t_2\in T\)</span>. Dado que esta es la <a href="./estadistica.html#def-cov">covarianza</a> dentro de la misma serie temporal, se refiere a ella como <em>autocovarianza</em>. De igual manera, se refiere a la <a href="./estadistica.html#def-corr">correlación</a> dentro de una misma serie como <em>autocorrelación</em> y se denotan por</p>
<p><span id="eq-autocov"><span class="math display">\[
\gamma(t_1,t_2):=\mathrm{E}[(X(t_1)-\mu(t_1))(X(t_2)-\mu(t_2))]
\tag{5.1}\]</span></span></p>
<p>y</p>
<p><span id="eq-autocorr"><span class="math display">\[
\rho(t_1,t_2):= \frac{\gamma(t_1,t_2)}{\sigma(t_1)\sigma(t_2)}
\tag{5.2}\]</span></span></p>
<p>respectivamente.</p>
</div>
<section id="series-de-tiempo-estacionarias" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="series-de-tiempo-estacionarias"><span class="header-section-number">5.1.1</span> Series de tiempo estacionarias</h3>
<div style="text-align: justify">
<p>En el estudio de una serie de tiempo, es común que solo se tenga disponible una única realización de la serie. El análisis de una serie temporal basado únicamente en una realización es análogo a analizar las propiedades de una variable aleatoria en función de una sola observación. Los conceptos de estacionariedad y ergodicidad jugarán un papel importante en mejorar la capacidad de análisis de una serie temporal basada en una única realización de manera efectiva. Un proceso se considera estacionario si está en un estado de “equilibrio estadístico”. El comportamiento básico de dicha serie de tiempo no cambia con el tiempo. Como ejemplo, para dicho proceso, <span class="math inline">\(\mu(t)\)</span> no dependería del tiempo y, por lo tanto, podría ser denotado como <span class="math inline">\(\mu\)</span> para todo <span class="math inline">\(t\)</span>. Parecería que, dado que <span class="math inline">\(x(t)\)</span> para cada <span class="math inline">\(t\in T\)</span>, proporciona información sobre la media del conjunto <span class="math inline">\(\mu\)</span>, podría ser posible estimar <span class="math inline">\(\mu\)</span> en función de una única realización. Un proceso <strong>ergódico</strong> es aquel para el cual promedios de conjunto como <span class="math inline">\(\mu\)</span> pueden estimarse consistentemente a partir de una sola realización. En esta sección, se presentarán definiciones más formales de estacionariedad. La noción más restrictiva de estacionariedad es la de estacionariedad estricta, que se define de la siguiente manera.</p>
</div>
<div id="def-PPE" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.3 (Proceso estrictamente estacionario)</strong></span> Se dice que un proceso <span class="math inline">\(\{X(t); t \in T\}\)</span> es estrictamente estacionario si para cualquier <span class="math inline">\(t_1, t_2,\ldots, t_k \in T\)</span> y cualquier <span class="math inline">\(h \in T\)</span>, la distribución conjunta de <span class="math inline">\(\{X(t_1), X(t_2),\ldots , X(t_k)\}\)</span> es idéntica a la de <span class="math inline">\(\{X(t_1 + h), X(t_2 + h),\ldots, X(t_k + h)\}\)</span>.</p>
</div>
<div style="text-align: justify">
<p>La estacionariedad estricta requiere, entre otras cosas, que para cualquier <span class="math inline">\(t_1, t_2 \in T\)</span>, las distribuciones de <span class="math inline">\(X(t_1)\)</span> y <span class="math inline">\(X(t_2)\)</span> deben ser las mismas, y además que todas las distribuciones bivariadas de pares <span class="math inline">\(\{X(t), X(t + h)\}\)</span> sean iguales para todos los <span class="math inline">\(h\)</span>, etc. El requisito de estacionariedad estricta es riguroso y suele ser difícil de establecer matemáticamente. De hecho, para la mayoría de las aplicaciones, las distribuciones involucradas no se conocen. Por esta razón, se han desarrollado nociones menos restrictivas de estacionariedad. La más común de ellas es la estacionariedad por covarianza.</p>
</div>
<div id="def-estcov" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.4 (Estacionariedad por covarianza)</strong></span> La serie de tiempo <span class="math inline">\(\{X(t); t \in T\}\)</span> se considera estacionaria por covarianza si</p>
<ol type="i">
<li><p><span class="math inline">\(\mu_{_{X_t}}=\mathrm E[X(t)] = \mu\)</span> (media constante para todo <span class="math inline">\(t\)</span>).</p></li>
<li><p><span class="math inline">\(\sigma^2_{_{X_t}}=\mathrm{Var}[X(t)] = \sigma^2 &lt; \infty\)</span> (es decir, una constante finita para todo <span class="math inline">\(t\)</span>).</p></li>
<li><p><span class="math inline">\(\gamma_{_{X_{t_1},X_{t_2}}}\)</span> y <span class="math inline">\(\rho_{_{X_{t_1},X_{t_2}}}\)</span> depende solo de <span class="math inline">\(t_2 − t_1\)</span>.</p></li>
</ol>
</div>
<div style="text-align: justify">
<p>Si se cumple la condición iii., no habrá confusión al reemplazar la notación <span class="math inline">\(\gamma_{_{X_{t_1},X_{t_2}}}\)</span> con <span class="math inline">\(\gamma_{_{t_1-t_2}}\)</span> y, de manera similar, al denotar <span class="math inline">\(\rho_{_{X_{t_1},X_{t_2}}}\)</span> como <span class="math inline">\(\rho_{_{t_1-t_2}}\)</span>. Cuando se establece <span class="math inline">\(t_2-t_1=k\)</span>, se hace referencia a <span class="math inline">\(\gamma_{_k}\)</span> y <span class="math inline">\(\rho_{_k}\)</span> como la autocovarianza y la autocorrelación con un rezago de <span class="math inline">\(k\)</span>, respectivamente.</p>
<p>La función de autocovarianza de una serie de tiempo estacionaria satisface las siguientes propiedades:</p>
<ol type="i">
<li><p><span class="math inline">\(\gamma_{_0}=\mathrm E[(X_{t}-\mu)(X_{t}-\mu)]=\mathrm E[(X_{t}-\mu)^2]=\sigma^2\)</span>.</p></li>
<li><p><span class="math inline">\(|\gamma_{_k}|\leq \gamma_{_0}\)</span> para todo <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(\gamma_{_k}=\mathrm{E}[(X_{t-k}-\mu)(X_t-\mu)]=\mathrm{E}[(X_t-\mu)(X_{t-k}-\mu)]=\gamma_{_{-k}}\)</span>.</p></li>
<li><p>La función <span class="math inline">\(\gamma_{_k}\)</span> es semidefinida positiva. Esto es, para cualquier conjunto de puntos de tiempo <span class="math inline">\(t_1, t_2,\ldots,t_k\in T\)</span> y para los reales <span class="math inline">\(b_1,b_2,\ldots, b_k\)</span>, se tiene</p>
<p><span class="math display">\[\sum_{i=1}^k \sum_{j=1}^k \gamma(t_i-t_j)b_i b_j\geq 0.
\]</span></p></li>
</ol>
<p>La función de autocorrelación satisface las siguientes propiedades análogas:</p>
<ol type="i">
<li><p><span class="math inline">\(\rho_{_0} = 1\)</span>.</p></li>
<li><p><span class="math inline">\(|\rho_{_k}|\leq 1\)</span> para todo <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(\rho_{_k}=\rho_{_{-k}}\)</span>.</p></li>
<li><p>La función <span class="math inline">\(\rho_{_k}\)</span> es semidefinida positiva, y para series de tiempo discretas definidas en <span class="math inline">\(t = 0, 1, 2,\ldots\)</span>, la matriz</p>
<p><span class="math display">\[
\boldsymbol{\rho}_k = \begin{pmatrix}1 &amp; \rho_1 &amp; \ldots &amp; \rho_{_k}\\
\rho_1 &amp; 1 &amp; \ldots &amp; \rho_{k-1}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
\rho_{_k} &amp; \rho_{k+1}&amp;\ldots &amp; 1\end{pmatrix}
\]</span></p>
<p>es semidefinida positiva para cada <span class="math inline">\(k\)</span>.</p></li>
</ol>
</div>
<div class="proof remark" style="text-align: justify">
<p><span class="proof-title"><em>Observación</em>. </span>La estacionariedad por covarianza también se conoce como estacionariedad débil, estacionariedad en el sentido amplio y estacionariedad de segundo orden. En el resto de esta tesis, a menos que se especifique lo contrario, el término estacionariedad se referirá a la estacionariedad por covarianza.</p>
</div>
<div style="text-align: justify">
<p>En las series de tiempo, al igual que en la mayoría de las otras áreas de la estadística, los datos no correlacionados desempeñan un papel importante. No hay dificultad en definir dicho proceso en el caso de una serie temporal de parámetro discreto. Es decir, la serie temporal <span class="math inline">\(\{X_t; t = 0, \pm 1, \pm 2,\ldots\}\)</span> se llama “proceso puramente aleatorio” si los <span class="math inline">\(X_t\)</span> son variables aleatorias no correlacionadas. Al considerar procesos puramente aleatorios, solo nos interesará el caso en el que los <span class="math inline">\(X_t\)</span> también estén distribuidos de manera idéntica. En esta situación, es más común referirse a la serie de tiempo como ruido blanco. La siguiente definición resume estas observaciones.</p>
</div>
<div id="def-ruidob" class="theorem definition">
<p><span class="theorem-title"><strong>Definición 5.5 (Proceso de ruido blanco)</strong></span> Se dice que un proceso <span class="math inline">\(X_t\)</span> es ruido blanco si se cumplen las siguientes condiciones.</p>
<ol type="1">
<li><p>Los <span class="math inline">\(X_t\)</span> están distribuidos de manera idéntica.</p></li>
<li><p><span class="math inline">\(\gamma_{_{t_2-t_1}} = 0\)</span> cuando <span class="math inline">\(t_2 \ne t_1\)</span>.</p></li>
<li><p><span class="math inline">\(\gamma_{_{t-t}} = \sigma^2\)</span>, donde <span class="math inline">\(0 &lt; \sigma^2 &lt; \infty\)</span> .</p></li>
</ol>
</div>
<div style="text-align: justify">
<p>En un proceso de ruido blanco, cada observación está no correlacionada con todas las demás observaciones. Un hecho importante es que los procesos de ruido blanco son estacionarios.</p>
</div>
<section id="estimación-de-los-parámetros-de-un-proceso-estacionario." class="level4" data-number="5.1.1.1">
<h4 data-number="5.1.1.1" class="anchored" data-anchor-id="estimación-de-los-parámetros-de-un-proceso-estacionario."><span class="header-section-number">5.1.1.1</span> Estimación de los parámetros de un proceso estacionario.</h4>
<section id="estimación-de-mu." class="level5" data-number="5.1.1.1.1">
<h5 data-number="5.1.1.1.1" class="anchored" data-anchor-id="estimación-de-mu."><span class="header-section-number">5.1.1.1.1</span> Estimación de <span class="math inline">\(\mu\)</span>.</h5>
<div style="text-align: justify">
<p>Dada la realización <span class="math inline">\(\{x_t, t = 1, 2,\ldots , n\}\)</span> de una serie temporal estacionaria, la estimación natural de la media común <span class="math inline">\(\mu\)</span> es la media muestral</p>
<p><span id="eq-media"><span class="math display">\[
\bar{x}=\frac{1}{n}\sum_{t=1}^n x_t.
\tag{5.3}\]</span></span></p>
<p>Es evidente que el estimador <span class="math inline">\(\bar{X}\)</span> es imparcial para <span class="math inline">\(\mu\)</span>.</p>
<p>Para una serie temporal estacionaria, se pueden emplear los datos a lo largo del tiempo para estimar la media, dado que se asume que la media es constante para cada instante de tiempo <span class="math inline">\(t\)</span>.</p>
</div>
<section id="ergodicidad-de-x." class="level6" data-number="5.1.1.1.1.1">
<h6 data-number="5.1.1.1.1.1" class="anchored" data-anchor-id="ergodicidad-de-x."><span class="header-section-number">5.1.1.1.1.1</span> Ergodicidad de <span class="math inline">\(X\)</span>.</h6>
<div style="text-align: justify">
<p>Se dice que <span class="math inline">\(X\)</span> es ergódico para <span class="math inline">\(\mu\)</span> si <span class="math inline">\(X\)</span> converge en el sentido de la media cuadrática hacia <span class="math inline">\(\mu\)</span> a medida que <span class="math inline">\(n\)</span> aumenta, es decir, si <span class="math inline">\(\lim\limits_{n\to\infty}\mathrm{E}[(\bar X -\mu)^2]=0\)</span>.</p>
</div>
<div id="thm-ergo" class="theorem" style="text-align: justify">
<p><span class="theorem-title"><strong>Teorema 5.1</strong></span> Sea <span class="math inline">\(\{X_t; t=0,\pm 1,\pm 2, \ldots\}\)</span> una serie de tiempo estacionaria. Entonces, <span class="math inline">\(\bar X = \frac{1}{n}\sum\limits_{t=1}^n X_t\)</span> es ergódica para <span class="math inline">\(\mu\)</span> si y solo si</p>
<p><span id="eq-ergo"><span class="math display">\[
\lim\limits_{k\to \infty} \frac{1}{k} \sum_{j=0}^{k-1} \gamma_j =0.
\tag{5.4}\]</span></span></p>
<div class="proof">
<p><span class="proof-title"><em>Prueba</em>. </span>Vea <span class="citation" data-cites="Yaglom1962introduction">Yaglom (<a href="references.html#ref-Yaglom1962introduction" role="doc-biblioref">1962</a>)</span>.</p>
</div>
</div>
<div id="cor-ergo" class="theorem corollary" style="text-align: justify">
<p><span class="theorem-title"><strong>Corolario 5.1</strong></span> Sea <span class="math inline">\(X_t\)</span> una serie de tiempo estacionaria con parámetros discretos, como se establece en el <a href="#thm-ergo" class="quarto-xref">Teorema&nbsp;<span>5.1</span></a> . Entonces, <span class="math inline">\(\bar X\)</span> es ergódico para <span class="math inline">\(\mu\)</span> si</p>
<p><span id="eq-ergo1"><span class="math display">\[
\lim\limits_{k\to\infty} \gamma_{_k}=0,
\tag{5.5}\]</span></span></p>
<p>o equivalentemente si</p>
<p><span id="eq-ergo2"><span class="math display">\[
\lim\limits_{k\to\infty} \rho_{_k}=0.
\tag{5.6}\]</span></span></p>
</div>
<div style="text-align: justify">
<p>La condición suficiente para la ergodicidad de <span class="math inline">\(\bar X\)</span>, dada en el <a href="#cor-ergo" class="quarto-xref">Corolario&nbsp;<span>5.1</span></a>, resulta muy útil y es una condición que se cumple para la amplia clase de series temporales autorregresivas de media móvil, ARMA<span class="math inline">\((p,q)\)</span>, estacionarias, que se discutirán más adelante. A pesar de que <span class="math inline">\(X_t\)</span>’s “cercanos” en el tiempo pueden tener una correlación sustancial, la condición en el <a href="#cor-ergo" class="quarto-xref">Corolario&nbsp;<span>5.1</span></a> asegura que, para una “gran” separación, están casi no correlacionados.</p>
</div>
</section>
<section id="varianza-de-bar-x." class="level6" data-number="5.1.1.1.1.2">
<h6 data-number="5.1.1.1.1.2" class="anchored" data-anchor-id="varianza-de-bar-x."><span class="header-section-number">5.1.1.1.1.2</span> Varianza de <span class="math inline">\(\bar X\)</span>.</h6>
<div style="text-align: justify">
<p>Antes de abandonar el tema de estimar <span class="math inline">\(\mu\)</span> a partir de una realización de un proceso estacionario, en el <a href="#thm-varmedia" class="quarto-xref">Teorema&nbsp;<span>5.2</span></a> se proporciona una fórmula útil para la Varianza de <span class="math inline">\(\bar X\)</span>.</p>
<div id="thm-varmedia" class="theorem">
<p><span class="theorem-title"><strong>Teorema 5.2</strong></span> Sea <span class="math inline">\(X_t\)</span> una serie de tiempo estacionaria, la varianza de <span class="math inline">\(\bar X\)</span> basada en una realización de longitud <span class="math inline">\(n\)</span> está dada por</p>
<p><span id="eq-varmedia"><span class="math display">\[
\mathrm{Var}(\bar X)=\frac{\sigma_X^2}{n}\left(1+2\sum_{k=1}^{n-1}\left(1-\frac{|k|}{n}\right)\rho_{_k}\right).
\tag{5.7}\]</span></span></p>
</div>
</div>
<div style="text-align: justify">
<p>El resultado en la ecuación (<a href="#eq-varmedia" class="quarto-xref"><span>5.7</span></a>) muestra el efecto de la autocorrelación en la varianza de <span class="math inline">\(\bar X\)</span>, y si <span class="math inline">\(X_t\)</span> es ruido blanco, es decir, <span class="math inline">\(\gamma_{_{k}} = 0\)</span> si <span class="math inline">\(k \ne 0\)</span>, entonces la ecuación (<a href="#eq-varmedia" class="quarto-xref"><span>5.7</span></a>) se convierte en el conocido resultado <span class="math inline">\(Var(\bar X) = \sigma^2/n\)</span>.</p>
<p>Utilizando la notación <span class="math inline">\(\hat \rho_{_k}\)</span> para denotar las autocorrelaciones estimadas (muestra) y <span class="math inline">\(\hat\sigma^2=\hat{\gamma_0}\)</span> para denotar la varianza muestral, es práctica común obtener intervalos de confianza aproximados del <span class="math inline">\(95\%\)</span> para <span class="math inline">\(\mu\)</span> usando</p>
<p><span id="eq-iconf"><span class="math display">\[
\left(\bar X- 1.96\sqrt{\frac{\hat\sigma^2}{n}\sum_{k=-(n-1)}^{n-1}\left(1-\frac{|k|}{n}\right)\hat\rho_{_k}}, \bar X+ 1.96\sqrt{\frac{\hat\sigma^2}{n}\sum_{k=-(n-1)}^{n-1}\left(1-\frac{|k|}{n}\right)\hat\rho_{_k}}\right).
\tag{5.8}\]</span></span></p>
</div>
</section>
</section>
<section id="estimación-de-gamma__k." class="level5" data-number="5.1.1.1.2">
<h5 data-number="5.1.1.1.2" class="anchored" data-anchor-id="estimación-de-gamma__k."><span class="header-section-number">5.1.1.1.2</span> Estimación de <span class="math inline">\(\gamma_{_k}\)</span>.</h5>
<div style="text-align: justify">
<p>Debido a la estacionariedad, <span class="math inline">\(\mathrm E[(X_t − \mu)(X_{t+k} − \mu)] = \gamma_{_k}\)</span> no depende de <span class="math inline">\(t.\)</span> Como consecuencia, parece razonable estimar <span class="math inline">\(\gamma_{_k}\)</span> a partir de una sola realización, esto es</p>
<p><span id="eq-estgamma"><span class="math display">\[
\begin{split}\hat{\gamma}_{_k}&amp;= \frac{1}{n}\sum_{t=1}^{n-k}(X_t-\bar X)(X_{t+k}-\bar X), \quad 0\leq k\leq n\\
&amp;=0,\qquad k\ge n\\
&amp;=\hat{\gamma}_{_{-k}},\quad k&lt;0.\end{split}
\tag{5.9}\]</span></span></p>
</div>
<div class="proof remark" style="text-align: justify">
<p><span class="proof-title"><em>Observación</em>. </span>Usando la ecuación (<a href="#eq-estgamma" class="quarto-xref"><span>5.9</span></a>) se deduce que</p>
<p><span id="eq-hatgamma0"><span class="math display">\[
\hat{\gamma}_{_0}= \frac{1}{n}\sum_{t=1}^{n}(X_t-\bar X)^2.
\tag{5.10}\]</span></span></p>
</div>
</section>
<section id="estimación-de-rho__k." class="level5" data-number="5.1.1.1.3">
<h5 data-number="5.1.1.1.3" class="anchored" data-anchor-id="estimación-de-rho__k."><span class="header-section-number">5.1.1.1.3</span> Estimación de <span class="math inline">\(\rho_{_k}\)</span>.</h5>
<div id="def-samplecorr" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.6 (Autocorrelación muestral)</strong></span> El estimador de la autocorrelación, <span class="math inline">\(\rho_{_{k}}\)</span> se obtiene mediante</p>
<p><span id="eq-sampleautocor"><span class="math display">\[
\hat\rho_{_{k}}=\hat\gamma_{_{k}}/\hat\gamma_{_{0}}.
\tag{5.11}\]</span></span></p>
<p>A este estimador se le conoce como la autocorrelación muestral.</p>
</div>
<div style="text-align: justify">
<p>A partir del análisis de la ecuación (<a href="#eq-estgamma" class="quarto-xref"><span>5.9</span></a>) , es evidente que los valores de <span class="math inline">\(\hat\gamma_{_{k}}\)</span> (y <span class="math inline">\(\hat\rho_{_{k}}\)</span>) tenderán a ser “pequeños” cuando <span class="math inline">\(k\)</span> sea grande en relación con <span class="math inline">\(n\)</span>.</p>
</div>
</section>
</section>
</section>
<section id="conjuntos-de-datos-de-series-temporales." class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="conjuntos-de-datos-de-series-temporales."><span class="header-section-number">5.1.2</span> Conjuntos de datos de series temporales.</h3>
<div style="text-align: justify">
<p>Los comportamientos exhibidos por los datos de series temporales son diversos y se analizarán en las secciones subsiguientes. Dichos tipos de comportamiento se ilustrarán mediante ejemplos provenientes de la realidad, tales como los datos intrigantes de manchas solares, registros de temperatura, el índice Dow Jones, precios de acciones individuales, datos de ventas (tanto mensuales como diarios), entre otros. El análisis comenzará con una discusión sobre datos que presenten algún tipo de patrón cíclico (<span class="citation" data-cites="woodward2022time">Woodward, Sadler, y Robertson (<a href="references.html#ref-woodward2022time" role="doc-biblioref">2022</a>)</span>).</p>
</div>
<section id="datos-cíclicos" class="level4" data-number="5.1.2.1">
<h4 data-number="5.1.2.1" class="anchored" data-anchor-id="datos-cíclicos"><span class="header-section-number">5.1.2.1</span> Datos Cíclicos</h4>
<div style="text-align: justify">
<p>Muchos conjuntos de datos de series temporales muestran un patrón cíclico, lo que significa que los datos presentan aumentos y disminuciones de manera algo repetitiva. Estos datos a veces se denominan <em>“pseudo-periódicos”</em>, un término que usaremos de manera sinónima con <em>“cíclico”</em>. Los datos de manchas solares en la <a href="#fig-sunspot" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> son un ejemplo de datos cíclicos.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Observación</em>. </span>Los datos verdaderamente periódicos exhiben un comportamiento que se replica de manera precisa a lo largo de un período de tiempo establecido. Un caso ilustrativo de datos puramente periódicos se encuentra en la forma de la curva sinusoidal. De este modo, los datos pseudoperiódicos (o cíclicos) se refieren a aquellos conjuntos de datos que tienden a mostrar repeticiones en sus comportamientos.</p>
</div>
</div>
<div id="exm-sunspot" class="theorem example" style="text-align: justify">
<p><span class="theorem-title"><strong>Ejemplo 5.1</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Datos de manchas solares
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La <a href="#fig-sunspot" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> muestra datos anuales de manchas solares para los años 1700-2020. Las manchas solares son áreas de explosiones solares o disturbios atmosféricos extremos en el sol. En 1848, el astrónomo suizo Rudolf Wolf introdujo un método para contar la actividad de las manchas solares, y los datos mensuales utilizando su método están disponibles desde 1749. (<span class="citation" data-cites="waldmeier1961sunspot">Waldmeier (<a href="references.html#ref-waldmeier1961sunspot" role="doc-biblioref">1961</a>)</span>).</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sunspot2<span class="fl">.0</span>, <span class="at">xlab=</span><span class="st">'Año'</span>, <span class="at">ylab=</span><span class="st">'Manchas solares'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-sunspot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sunspot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="series_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sunspot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.1: Número anual de manchas solares desde 1700 hasta 2020.
</figcaption>
</figure>
</div>
<p>Las manchas solares han generado un considerable interés en la comunidad científica por dos razones principales:</p>
<ul>
<li><p>La actividad de las manchas solares tiende a afectarnos aquí en la Tierra. Por ejemplo, una alta actividad de manchas solares provoca interferencias en la comunicación por radio y se asocia con una mayor intensidad de luz ultravioleta y actividad de auroras boreales.</p></li>
<li><p>La actividad de las manchas solares tiene un comportamiento cíclico que tiene una duración de ciclo de aproximadamente 11 años. Al examinar la <a href="#fig-sunspot" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> se observa que hay 29 ciclos en los 321 años, con una duración media del ciclo de aproximadamente 11 años. De hecho, las duraciones de los ciclos tienden a variar aleatoriamente entre 9 y 13 años.</p></li>
</ul>
<p>Si bien, el comportamiento cíclico en la <a href="#fig-sunspot" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> es claro, a menudo es útil examinar fragmentos cortos de los datos para visualizar mejor el comportamiento específico. La <a href="#fig-sunsfrag" class="quarto-xref">Figura&nbsp;<span>5.2</span></a> muestra el número de manchas solares desde 1867 hasta 1950. Las líneas verticales identifican los años en los que hubo un pico en los números de manchas solares y las flechas horizontales representan el tiempo entre los picos. Para los años representados en la <a href="#fig-sunsfrag" class="quarto-xref">Figura&nbsp;<span>5.2</span></a>, las duraciones de los ciclos fueron de 13, 10, 12, 12, 11, 9 y 10 años, respectivamente. Las duraciones de los ciclos parecen variar aleatoriamente y no parece haber un “ajuste a una duración de ciclo fija”. De hecho, según la comprensión de estos autores, los científicos no tienen una explicación física para el ciclo de aproximadamente 11 años. Los datos de las manchas solares son un ejemplo clásico de datos cíclicos con duraciones de ciclo variables. De hecho, <span class="citation" data-cites="yule1971method">Yule (<a href="references.html#ref-yule1971method" role="doc-biblioref">1971</a>)</span> desarrolló el proceso autorregresivo como un medio para describir el comportamiento periódico “perturbado” de los datos de las manchas solares.</p>
<div id="fig-sunsfrag" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sunsfrag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="series_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sunsfrag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.2: Fragmento de la <a href="#fig-sunspot" class="quarto-xref">Figura&nbsp;<span>5.1</span></a> que muestra los años 1867-1950
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="exm-airpass" class="theorem example" style="text-align: justify">
<p><span class="theorem-title"><strong>Ejemplo 5.2</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Datos de pasajeros aéreos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La <a href="#fig-airpass" class="quarto-xref">Figura&nbsp;<span>5.3</span></a> es un conjunto de datos que contiene el número total (en miles) de pasajeros de líneas aéreas internacionales por mes durante los 12 años, desde 1949 hasta 1960. Estos datos han sido analizados exhaustivamente y son un conjunto de datos clásico en la literatura de series temporales. Los datos siguen un patrón cíclico de 12 meses que es similar de un año a otro y está basado en el año calendario. Por lo tanto, los datos de pasajeros aéreos son otro ejemplo de datos estacionales. Además, los datos tienden a mostrar una tendencia al alza con el tiempo. Es decir, el número de pasajeros de líneas aéreas está aumentando con el tiempo. El comportamiento de tendencia en series temporales se discutirá en la <a href="#sec-trend" class="quarto-xref"><span>Sección 5.1.2.2</span></a>. También hay una variabilidad creciente dentro del año. Este tipo de comportamiento es conocido como <em>estacionalidad multiplicativa</em>.</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers, <span class="at">xlab=</span><span class="st">'Año'</span>, <span class="at">ylab=</span><span class="st">'Número de pasajeros'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-airpass" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-airpass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="series_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-airpass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.3: Número de Pasajeros Internacionales en Aerolíneas de 1949 a 1960
</figcaption>
</figure>
</div>
<p>La <a href="#fig-airfrag" class="quarto-xref">Figura&nbsp;<span>5.4</span></a> muestra un fragmento de los datos de pasajeros aéreos desde 1957 hasta 1960. Se observa que el viaje aéreo es ligero desde Enero hasta Abril, aumenta durante los meses de verano y comienza a disminuir en septiembre hasta noviembre con un ligero aumento en diciembre. Este patrón, aunque no es sinusoidal, se repite de un año a otro. El comportamiento cíclico de los datos de pasajeros aéreos se repite anualmente y son un ejemplo de datos estacionales que no son seudosenoidales.</p>
<div id="fig-airfrag" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-airfrag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="series_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-airfrag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.4: Fragmento de la <a href="#fig-airpass" class="quarto-xref">Figura&nbsp;<span>5.3</span></a> que muestra los años 1957-1960
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-trend" class="level4" data-number="5.1.2.2">
<h4 data-number="5.1.2.2" class="anchored" data-anchor-id="sec-trend"><span class="header-section-number">5.1.2.2</span> Tendencias</h4>
<div style="text-align: justify">
<p>Una tendencia, en un contexto de análisis de datos, se refiere a la inclinación de una serie de datos al experimentar un incremento o disminución constante a lo largo del tiempo. En el caso específico de los datos de Pasajeros Aéreos mostrados en la <a href="#fig-airpass" class="quarto-xref">Figura&nbsp;<span>5.3</span></a>, se identifica un patrón de crecimiento además del patrón estacional previamente observado. Una tendencia lineal se caracteriza por el aumento o la disminución de los datos de manera constante y progresiva, tal como se ilustra en la <a href="#fig-lineal" class="quarto-xref">Figura&nbsp;<span>5.5 (a)</span></a>. Las tendencias pueden seguir una curva, como lo ejemplifica la tendencia exponencial en la <a href="#fig-expo" class="quarto-xref">Figura&nbsp;<span>5.5 (b)</span></a>. Por otro lado, la <a href="#fig-desc" class="quarto-xref">Figura&nbsp;<span>5.5 (c)</span></a> exhibe una serie temporal con una tendencia descendente, pero su naturaleza es más irregular en comparación con las tendencias representadas en las Figuras (a) y (b). Un patrón común en conjuntos de datos es un comportamiento de tendencia aleatoria, como se muestra en la <a href="#fig-deam" class="quarto-xref">Figura&nbsp;<span>5.5 (d)</span></a>, la cual sugiere una trayectoria sin un rumbo definido. Esto implica que pueden existir tendencias de corta o larga duración, en ocasiones en direcciones opuestas.</p>
</div>
<div id="fig-trends" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trends-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-trends" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-lineal" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lineal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Imagenes/lineal.png" class="img-fluid figure-img" data-ref-parent="fig-trends">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lineal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Tendencia lineal
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-trends" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-expo" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-expo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Imagenes/exponencial.png" class="img-fluid figure-img" data-ref-parent="fig-trends">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-expo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Tendencia exponencial
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-trends" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-desc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Imagenes/abajo.png" class="img-fluid figure-img" data-ref-parent="fig-trends">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Tendencia descendente
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-trends" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-deam" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-deam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Imagenes/deambulante.png" class="img-fluid figure-img" data-ref-parent="fig-trends">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-deam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Comportamiento deambulante
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trends-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.5: Gráficos que muestran (a) una tendencia lineal, (b) una tendencia exponencial, (c) una tendencia descendente irregular y (d) un patrón de deambulación.
</figcaption>
</figure>
</div>
<div id="def-aper" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.7</strong></span> La función <span class="math inline">\(g(t)\)</span> es <em>periódica</em> con periodo (o longitud del ciclo) <span class="math inline">\(p &gt; 0\)</span> si <span class="math inline">\(p\)</span> es el valor más pequeño tal que <span class="math inline">\(g(t) = g(t + kp)\)</span> para todo <span class="math inline">\(t\)</span> y enteros <span class="math inline">\(k\)</span>. Se dice que una función <span class="math inline">\(g(t)\)</span> es <em>aperiódica</em> si no existe tal <span class="math inline">\(p\)</span>.</p>
</div>
<div id="def-freq" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.8 (Frecuencia)</strong></span> La frecuencia, denotada por <span class="math inline">\(f\)</span>, puede ser descrita de las siguientes dos maneras;</p>
<ol type="1">
<li><p><span class="math inline">\(f=1/\text{periodo}\)</span> (tamaño del ciclo).</p></li>
<li><p>El número de ciclos en la función a través de una unidad de tiempo.</p></li>
</ol>
</div>
<div class="proof remark" style="text-align: justify">
<p><span class="proof-title"><em>Observación</em>. </span>Los datos con comportamiento de tendencia y deambulación aleatoria no son cíclicos por naturaleza. A veces se les llama aperiódicos debido a la ausencia de un comportamiento regular de ascenso y descenso.</p>
</div>
</section>
<section id="definición-y-propiedades-del-espectro-y-densidad-espectral" class="level4" data-number="5.1.2.3">
<h4 data-number="5.1.2.3" class="anchored" data-anchor-id="definición-y-propiedades-del-espectro-y-densidad-espectral"><span class="header-section-number">5.1.2.3</span> Definición y propiedades del espectro y densidad espectral</h4>
<div id="def-spec" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.9</strong></span> Sea <span class="math inline">\(X_{_t}\)</span> una serie de tiempo estacionaria con autocovarianza <span class="math inline">\(\gamma_{_k}\)</span> y autocorrelación <span class="math inline">\(\rho_{_k}\)</span>. Entonces para <span class="math inline">\(|f|\le 0.5\)</span>:</p>
<ol type="i">
<li><p>El <em>espectro</em> de <span class="math inline">\(X_{_t}\)</span> se define como</p>
<p><span id="eq-spectrum"><span class="math display">\[
P_{_X}(f)=\sum_{k=-\infty}^\infty e^{-2\pi ifk}\gamma_{_k}.
\tag{5.12}\]</span></span></p></li>
<li><p>La <em>densidad espectral</em> de <span class="math inline">\(X_{_t}\)</span> se define como</p>
<p><span id="eq-spectden"><span class="math display">\[
S_{_X}(f)=\sum_{k=-\infty}^\infty e^{-2\pi ifk}\rho_{_k}.
\tag{5.13}\]</span></span></p></li>
</ol>
</div>
<div style="text-aling: justify">
<p>Usando la fórmula de Euler en las ecuaciones (<a href="#eq-spectrum" class="quarto-xref"><span>5.12</span></a>) y (<a href="#eq-spectden" class="quarto-xref"><span>5.13</span></a>), se obtienen las siguientes fórmulas.</p>
<p><span class="math display">\[
P_{_X}(f)=\sigma_{_X}^2+2\sum_{k=1}^\infty\gamma_{_k}\cos(2\pi fk),
\]</span></p>
<p><span class="math display">\[
S_{_X}(f)=1+2\sum_{k=1}^\infty \rho_{_k}\cos(2\pi fk).
\]</span></p>
<p>Estas fórmulas enfatizan que el espectro y la densidad espectral son funciones de valor real, lo que no es evidente en las ecuaciones (<a href="#eq-spectrum" class="quarto-xref"><span>5.12</span></a>) y (<a href="#eq-spectden" class="quarto-xref"><span>5.13</span></a>).</p>
<p><strong><em>Propiedades importantes de densidades espectrales</em></strong></p>
<ol type="i">
<li><p><span class="math inline">\(S_{_X}(f)\geq 0\)</span>.</p></li>
<li><p><span class="math inline">\(S_{_X}(f)=S_{_X}(-f)\)</span>.</p></li>
<li><p><span class="math inline">\(S_{_X}(f)=1+2\sum\limits_{k=1}^\infty \rho_{_k}\cos(2\pi fk)\)</span>, donde <span class="math inline">\(|f|\le 0.5\)</span> .</p></li>
<li><p><span class="math inline">\(\sum\limits_{-0.5}^{0.5}S_{_X}(f)e^{2\pi ifk}df=\rho_{_k}\)</span>.</p>
<p>Las propiedades i y ii muestran que <span class="math inline">\(S_{_X}(f)\)</span> es una función par no negativa.</p></li>
</ol>
</div>
</section>
</section>
<section id="suavizado-de-datos-de-series-temporales." class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="suavizado-de-datos-de-series-temporales."><span class="header-section-number">5.1.3</span> Suavizado de datos de series temporales.</h3>
<div style="text-align: justify">
<p>Existen varios métodos para “suavizar” el comportamiento ruidoso (posiblemente poco importante) de una serie temporal, para que se pueda entender mejor una señal importante subyacente. Se comienza discutiendo el método de suavizado de promedio móvil centrado, que es el más básico.</p>
</div>
<section id="sec-mas" class="level4" data-number="5.1.3.1">
<h4 data-number="5.1.3.1" class="anchored" data-anchor-id="sec-mas"><span class="header-section-number">5.1.3.1</span> Suavizado de datos utilizando un suavizador de promedio móvil centrado</h4>
<div style="text-align: justify">
<p>El suavizador de promedio móvil centrado es un método para reemplazar los valores de datos en una serie temporal con un promedio de los valores de datos que rodean (e incluyen) ese punto de datos. Por ejemplo, un suavizador de promedio móvil centrado de orden tres reemplaza un valor de datos <span class="math inline">\(x_{_t}\)</span> en el tiempo <span class="math inline">\(t\)</span> con <span class="math inline">\(s_{_t} = (x_{_{t-1}}+x_{_t}+x_{_{t+1}})/3\)</span>. Es decir, se asigna el valor promedio al punto de tiempo medio. Por lo tanto, un suavizador de promedio móvil centrado de orden tres no puede asignarse al primer o último punto de tiempo de una serie temporal. Se sigue que a mayor orden, más valores faltarán al principio y al final del conjunto de datos suavizado. Para un promedio móvil centrado de tercer orden, la fórmula de promediado se desplaza a lo largo del conjunto de datos de la serie temporal, considerando tres valores de datos consecutivos juntos hasta llegar a los últimos tres puntos temporales.</p>
</div>
<div id="def-CMAS" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.10 (Suavizador de Promedio Móvil Centrado)</strong></span> Sea <span class="math inline">\(x_{_t}, t=1,\ldots,n\)</span> un conjunto de datos de series temporales. El suavizador de promedio móvil centrado se define de la siguiente manera:</p>
<p><strong><em>Caso 1:</em></strong> <span class="math inline">\(m\)</span> <strong><em>es un número impar.</em></strong></p>
<p>Sea <span class="math inline">\(k= (m−1)/2\)</span>. Para <span class="math inline">\(k &lt;t&lt; n - k\)</span>, el valor de los datos suavizados, <span class="math inline">\(s_{_t}\)</span>, en el tiempo <span class="math inline">\(t\)</span> se da por</p>
<p><span id="eq-mimpar"><span class="math display">\[
s_{_t}=\frac{1}{m}\sum_{i=t-k}^{t+k}x_{_i}.
\tag{5.14}\]</span></span></p>
<p><strong><em>Caso 2:</em></strong> <span class="math inline">\(m\)</span> <strong><em>es un número par.</em></strong></p>
<p>Sea <span class="math inline">\(k= m/2\)</span>. Para <span class="math inline">\(k &lt;t&lt; n - k\)</span>, el valor de los datos suavizados, <span class="math inline">\(s_{_t}\)</span>, en el tiempo <span class="math inline">\(t\)</span> está dado por</p>
<p><span id="eq-mpar"><span class="math display">\[
s_{_t}= \frac{x_{_{t-k}}}{2m}+\frac{1}{m}\sum_{i=t-k+1}^{t+k-1}x_{_i}+\frac{x_{_{t+k}}}{2m}.
\tag{5.15}\]</span></span></p>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="text-align: justify">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Para un promedio móvil centrado de quinto orden en tiempos <span class="math inline">\(2 &lt;t &lt; n -2\)</span> , se tiene</p>
<p><span class="math display">\[
s_{_t}=(x_{_{t-2}}+x_{_{t-1}}+x_{_t}+x_{_{t+1}}+x_{_{t+2}})/5.
\]</span></p></li>
<li><p>El suavizador de promedio móvil de cuarto orden en tiempos <span class="math inline">\(2 &lt;t &lt; n -2\)</span> , está dado por</p>
<p><span class="math display">\[
s_{_t}=\frac{x_{_{t-2}}}{8}+\frac{x_{_{t-1}}+x_{_t}+x_{_{t+1}}}{4}+\frac{x_{_{t+2}}}{8}
\]</span></p></li>
</ul>
<p>El suavizador de promedio móvil centrado tiene dos usos básicos:</p>
<ul>
<li><p>Suavizado diseñado para eliminar fluctuaciones (potencialmente sin sentido) de los datos.</p></li>
<li><p>Eliminar el comportamiento cíclico de datos estacionales u otros datos cíclicos con longitudes de ciclo fijas.</p></li>
</ul>
</div>
</div>
</div>
<div style="text-align: justify">
<p>El <a href="#exm-ejem" class="quarto-xref">Ejemplo&nbsp;<span>5.3</span></a> muestra el uso del suavizado de promedio móvil centrado con el propósito de detectar o comprender mejor señales subyacentes y fundamentales en los datos.</p>
<div id="exm-ejem" class="theorem example" style="text-align: justify">
<p><span class="theorem-title"><strong>Ejemplo 5.3</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suavizando los datos de temperatura de Tesla y DFW.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Los precios de las acciones de Tesla desde el 1 de enero de 2020 hasta el 30 de abril de 2021 se muestran en la <a href="#fig-charts-1" class="quarto-xref">Figura&nbsp;<span>5.6 (a)</span></a>. Se observa el hecho de que hubo un aumento constante hasta principios de 2021, momento en el cual el precio se estabilizó y disminuyó. Sin embargo, hay una considerable fluctuación de un día para otro, especialmente en 2021. La <a href="#fig-charts-4" class="quarto-xref">Figura&nbsp;<span>5.6 (d)</span></a> muestra las temperaturas medias anuales de DFW (Dallas Ft. Worth) desde 1900 hasta 2020. Allí se observa una considerable fluctuación de un año a otro, pero algo de aumento a partir de aproximadamente 2000. En la <a href="#fig-charts" class="quarto-xref">Figura&nbsp;<span>5.6</span></a>, incisos <a href="#fig-charts-2" class="quarto-xref"><span>5.6 (b)</span></a>, <a href="#fig-charts-3" class="quarto-xref"><span>5.6 (c)</span></a>, <a href="#fig-charts-5" class="quarto-xref"><span>5.6 (e)</span></a> y <a href="#fig-charts-6" class="quarto-xref"><span>5.6 (f)</span></a>, se muestran versiones suavizadas de la misma figura pero de los incisos <a href="#fig-charts-1" class="quarto-xref"><span>5.6 (a)</span></a> y <a href="#fig-charts-4" class="quarto-xref"><span>5.6 (d)</span></a>. Al utilizar el suavizador de promedio móvil centrado, las fluctuaciones de un día para otro se suavizan; se nota que el orden 8 produce más suavizado que el orden 3. El comportamiento fundamental, incluida la estabilización y disminución a principios de 2021, se ve con más claridad al minimizar los cambios ruidosos de un día para otro. El efecto del suavizado es más evidente en los datos de temperatura de DFW. La fluctuación de un año a otro es bastante dramática en el conjunto de datos original en la <a href="#fig-charts-4" class="quarto-xref">Figura&nbsp;<span>5.6 (d)</span></a>. Un suavizado de orden 3 proporciona cierta claridad, pero el suavizado de orden 8 mostrado en la <a href="#fig-charts-5" class="quarto-xref">Figura&nbsp;<span>5.6 (e)</span></a> muestra claramente un comportamiento casi estable desde 1900 hasta aproximadamente 1985. Desde entonces, ha habido un aumento que puede haberse estabilizado o no en los últimos años. Es particularmente notable en la <a href="#fig-charts-5" class="quarto-xref">Figura&nbsp;<span>5.6 (e)</span></a> que el suavizado ha eliminado los extremos. Específicamente, las temperaturas extremadamente altas en 2012, 2016 y 2017 se ven moderadas por las temperaturas más bajas en los años circundantes. (Tomado de <span class="citation" data-cites="woodward2022time">Woodward, Sadler, y Robertson (<a href="references.html#ref-woodward2022time" role="doc-biblioref">2022</a>)</span>)</p>
<div id="fig-charts" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-charts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-1.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Precios de las acciones de Tesla
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-2.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) MA Smoother Tesla: Orden=3
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-3.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) MA Smoother Tesla: Orden=8
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-4.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Temperatura anual DFW
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-5.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) MA Smoother DFW: Orden=3
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-charts" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-charts-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-charts-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-charts-6.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-charts-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f) MA Smoother DFW: Orden=8
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-charts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.6: Precios de las acciones de Tesla y datos de temperatura anual de DFW antes y después de aplicar suavizadores de promedio móvil de orden 3 y 8
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="análisis-y-técnicas-de-descomposición." class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="análisis-y-técnicas-de-descomposición."><span class="header-section-number">5.2</span> Análisis y técnicas de descomposición.</h2>
<section id="descomposición-de-datos-estacionales" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="descomposición-de-datos-estacionales"><span class="header-section-number">5.2.1</span> Descomposición de datos estacionales</h3>
<div style="text-align: justify">
<p>En el <a href="#exm-airpass" class="quarto-xref">Ejemplo&nbsp;<span>5.2</span></a> se aborda la naturaleza de los datos estacionales, entendidos como una serie de datos cíclicos con periodos consistentes y un patrón que guarda relación con el calendario. El conjunto de datos de AirPassengers presentado en la <a href="#fig-airpass" class="quarto-xref">Figura&nbsp;<span>5.3</span></a> se clasifica como un ejemplo paradigmático de datos estacionales. Este conjunto de datos exhibe un comportamiento estacional anual, además de una tendencia de crecimiento, que se aproxima a ser lineal. Es convencional considerar que los datos estacionales, denotados como <span class="math inline">\(x_{_t}\)</span>, comprenden:</p>
<ol type="a">
<li><p>Un componente estacional intrínseco anual, identificado como <span class="math inline">\(s_{_t}\)</span>,</p></li>
<li><p>Un componente de tendencia a largo plazo, referido como <span class="math inline">\(tr_{_t}\)</span> y,</p></li>
<li><p>Un componente de variabilidad aleatoria, conocido como <span class="math inline">\(z_{_t}\)</span>.</p></li>
</ol>
<p>Se ha observado esta estructura en el conjuntos de datos ya mencionado. Los expertos en análisis de series temporales se enfocan en dos categorías de modelos estacionales:</p>
<p><em>Datos estacionales aditivos</em></p>
<p>Los datos <span class="math inline">\(x_{_t}\)</span>, en el tiempo <span class="math inline">\(t\)</span> pueden ser considerados como una suma dada en la ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>)</p>
<p><span id="eq-addseas"><span class="math display">\[
x_{_t}=s_{_t}+tr_{_t}+z_{_t}.
\tag{5.16}\]</span></span></p>
<p><em>Datos estacionales multiplicativos</em></p>
<p>Los datos, <span class="math inline">\(x_{_t}\)</span>, en el tiempo <span class="math inline">\(t\)</span> pueden ser expresados como el producto dado en la ecuación (<a href="#eq-mulseas" class="quarto-xref"><span>5.17</span></a>)</p>
<p><span id="eq-mulseas"><span class="math display">\[
x_{_t}=s_{_t}\times tr_{_t}\times z_{_t}.
\tag{5.17}\]</span></span></p>
</div>
<div id="exm-air" class="theorem example" style="text-align: justify">
<p><span class="theorem-title"><strong>Ejemplo 5.4</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Datos de pasajeros aéreos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Para ilustrar la diferencia entre los tipos de datos que se ajustan mejor a un modelo aditivo y a uno multiplicativo, se utiliza el conjunto de datos de AirPassengers. Como se ha señalado anteriormente, los datos de AirPassengers, representados en la <a href="#fig-air-1" class="quarto-xref">Figura&nbsp;<span>5.7 (a)</span></a>, tienen un componente estacional y de tendencia, pero también la variabilidad dentro del año aumenta con el tiempo.</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>logAirPassengers<span class="ot">=</span><span class="fu">log</span>(AirPassengers)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logAirPassengers)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-air" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-air-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-air" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-air-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-air-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-air-1.png" class="img-fluid figure-img" data-ref-parent="fig-air" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-air-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Datos de pasajeros aéreos: 1949-1960
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-air" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-air-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-air-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-air-2.png" class="img-fluid figure-img" data-ref-parent="fig-air" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-air-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Datos de pasajeros aéreos en escala logarítmica
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-air-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.7: Datos de pasajeros aereos y logaritmo de los datos de pasajeros aereos
</figcaption>
</figure>
</div>
<p>Los conjuntos de datos con este tipo de comportamiento suelen modelarse utilizando modelos multiplicativos. Para eliminar el aumento en la variabilidad, los analistas suelen tomar el logaritmo de los datos y utilizan los “datos logarítmicos” para el análisis.</p>
<p>Los datos logarítmicos de logAirPassengers en la <a href="#fig-air-2" class="quarto-xref">Figura&nbsp;<span>5.7 (b)</span></a> no muestran un aumento en la variabilidad dentro del año y son un ejemplo clásico de datos que se modelan utilizando el modelo aditivo en la ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>).</p>
</div>
</div>
</div>
</div>
<p>Se comenzó discutiendo el modelo aditivo, considerado el más intuitivo de los dos.</p>
<div style="text-align: justify">
<p>A continuación, se discutirán las diferencias en las estrategias de modelado para estos dos conjuntos de datos.</p>
<p>Las descomposiciones aditivas y multiplicativas siguen pasos de implementación similares:</p>
<ol type="1">
<li>Estimar el componente de tendencia.</li>
<li>Eliminar el componente de tendencia, lo que resulta en un conjunto de datos compuesto principalmente por las fluctuaciones estacionales en los datos.</li>
<li>Calcular un componente estacional “promedio” dentro del año.</li>
<li>Encontrar el ruido restante.</li>
</ol>
<p>Se comenzará discutiendo el modelo aditivo, que es el más intuitivo de los dos.</p>
</div>
<section id="descomposición-aditiva" class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="descomposición-aditiva"><span class="header-section-number">5.2.1.1</span> Descomposición aditiva</h4>
<div style="text-align: justify">
<p>Cuando se analizan datos utilizando el modelo aditivo en la ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>), se parte del supuesto de que los datos son la suma de componentes estacionales, de tendencia y de ruido aleatorio. Se discuten los pasos de análisis involucrados en la descomposición de los datos logarítmicos de logAirPassengers. En la práctica, los componentes en la ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>) se estiman y un modelo estimado puede describirse como</p>
<p><span id="eq-addecompose"><span class="math display">\[
x_{_t}=\hat{s_{_t}}+\hat{tr_{_t}}+\hat{z_{_t}}.
\tag{5.18}\]</span></span></p>
<div id="exm-logair" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 5.5</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="text-align: justify">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Descomposición aditiva de LogAirPassengers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La descomposición de los datos logAirPassengers se logra mediante los siguientes pasos.</p>
<ol type="a">
<li><p><strong><em>Estimar el Componente de Tendencia</em></strong>: La <a href="#fig-sm12" class="quarto-xref">Figura&nbsp;<span>5.8</span></a> es una representación gráfica del conjunto de datos logAirPassengers superpuesto con el resultado de aplicar un suavizador de media móvil centrada de orden 12 a los datos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>logAirPassengers<span class="ot">=</span><span class="fu">log</span>(AirPassengers)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>logair<span class="fl">.12</span><span class="ot">=</span><span class="fu">ma.smooth.wge</span>(logAirPassengers,<span class="at">order=</span><span class="dv">12</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>logair<span class="fl">.12</span><span class="sc">$</span>smooth</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]       NA       NA       NA       NA       NA       NA 4.837280 4.841114
  [9] 4.846596 4.851238 4.854488 4.859954 4.869840 4.881389 4.893411 4.904293
 [17] 4.912752 4.923701 4.940483 4.957406 4.974380 4.991942 5.013095 5.033804
 [25] 5.047776 5.060902 5.073812 5.088378 5.106906 5.124312 5.138282 5.152751
 [33] 5.163718 5.171454 5.178401 5.189431 5.203909 5.218093 5.231553 5.243722
 [41] 5.257413 5.270736 5.282916 5.292150 5.304079 5.323338 5.343560 5.357427
 [49] 5.367695 5.378309 5.388417 5.397805 5.403849 5.407220 5.410364 5.410294
 [57] 5.408381 5.406761 5.406218 5.410571 5.419628 5.428330 5.435128 5.442237
 [65] 5.450659 5.461103 5.473655 5.489713 5.503974 5.516367 5.529403 5.542725
 [73] 5.557864 5.572693 5.587498 5.602730 5.616658 5.631189 5.645937 5.659812
 [81] 5.674172 5.687636 5.700766 5.714738 5.727153 5.738856 5.750676 5.760658
 [89] 5.770846 5.780430 5.788745 5.796524 5.804821 5.814072 5.823075 5.832692
 [97] 5.842665 5.853541 5.864863 5.875490 5.885654 5.894475 5.901555 5.907026
[105] 5.910012 5.910708 5.911637 5.913829 5.917360 5.922887 5.926146 5.927563
[113] 5.929657 5.930458 5.932964 5.938377 5.946188 5.956352 5.967813 5.977291
[121] 5.985269 5.994078 6.003991 6.014899 6.026589 6.040709 6.054492 6.066195
[129] 6.073088 6.080733 6.091930 6.102013 6.112511 6.121153 6.128381 6.137437
[137] 6.145733 6.151526       NA       NA       NA       NA       NA       NA</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>logair.sm12<span class="ot">=</span><span class="fu">ts</span>(logair<span class="fl">.12</span><span class="sc">$</span>smooth,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sm12" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sm12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-sm12-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sm12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.8: LogAirPassengers con un suavizador de promedio móvil centrado de orden 12.
</figcaption>
</figure>
</div>
</div>
</div>
<p>En relación con el modelo estimado en la ecuación (<a href="#eq-addecompose" class="quarto-xref"><span>5.18</span></a>), <span class="math inline">\(\hat{tr_{_t}} =\)</span> <strong>logair.sm12</strong> representa la curva casi lineal en la <a href="#fig-sm12" class="quarto-xref">Figura&nbsp;<span>5.8</span></a>.</p></li>
<li><p><strong><em>Eliminar el Componente de Tendencia de los Datos:</em></strong> El paso subsiguiente implica la sustracción del componente de tendencia estimado de los datos (logAirPassengers).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>seas.logair<span class="ot">=</span>logAirPassengers<span class="sc">-</span>logair.sm12</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(seas.logair,<span class="dv">4</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Jan     Feb     Mar     Apr     May     Jun     Jul     Aug     Sep
1949      NA      NA      NA      NA      NA      NA  0.1599  0.1561  0.0661
1950 -0.1249 -0.0451  0.0553  0.0010 -0.0844  0.0802  0.1953  0.1784  0.0882
1951 -0.0710 -0.0503  0.1080  0.0054  0.0406  0.0575  0.1550  0.1406  0.0512
1952 -0.0622 -0.0251  0.0311 -0.0452 -0.0479  0.1138  0.1552  0.1968  0.0383
1953 -0.0896 -0.1002  0.0754  0.0618  0.0299  0.0858  0.1656  0.1955  0.0597
1954 -0.1015 -0.1919  0.0245 -0.0173  0.0047  0.1148  0.2368  0.1905  0.0529
1955 -0.0689 -0.1217 -0.0002 -0.0080 -0.0182  0.1214  0.2512  0.1895  0.0688
1956 -0.0782 -0.1148  0.0082 -0.0145 -0.0088  0.1438  0.2347  0.2074  0.0673
1957 -0.0901 -0.1464  0.0101 -0.0233 -0.0135  0.1505  0.2405  0.2393  0.0914
1958 -0.0884 -0.1608 -0.0345 -0.0754 -0.0353  0.1449  0.2635  0.2862  0.0552
1959 -0.0992 -0.1593  0.0024 -0.0335  0.0137  0.1163  0.2518  0.2600  0.0646
1960 -0.0794 -0.1524 -0.0905 -0.0040  0.0112  0.1307      NA      NA      NA
         Oct     Nov     Dec
1949 -0.0721 -0.2101 -0.0893
1950 -0.1016 -0.2769 -0.0922
1951 -0.0839 -0.1948 -0.0774
1952 -0.0711 -0.1961 -0.0896
1953 -0.0549 -0.2133 -0.1073
1954 -0.0826 -0.2162 -0.1090
1955 -0.0745 -0.2327 -0.0871
1956 -0.0905 -0.2210 -0.1091
1957 -0.0614 -0.1913 -0.0967
1958 -0.0730 -0.2312 -0.1572
1959 -0.0719 -0.2003 -0.0981
1960      NA      NA      NA</code></pre>
</div>
</div></li>
</ol>
<div id="fig-seasair" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-seasair" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-seasair-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-seasair-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-seasair-1.png" class="img-fluid figure-img" data-ref-parent="fig-seasair" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-seasair-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) LogAirPassengers sin tendencia
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-seasair" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-seasair-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-seasair-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-seasair-2.png" class="img-fluid figure-img" data-ref-parent="fig-seasair" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-seasair-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Componente estacional estimado
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.9: Datos de LogAirPassengers sin el componente de tendencia y componente estacional estimado.
</figcaption>
</figure>
</div>
<p>Se aprecia con mayor claridad el comportamiento estacional año tras año en la <a href="#fig-seasair-1" class="quarto-xref">Figura&nbsp;<span>5.9 (a)</span></a> sin la “interferencia” de la tendencia. Específicamente, se observa un patrón similar en cada año (mayor cantidad de viajes en verano, disminución en noviembre, aún bajos pero con una ligera alza en diciembre, continuamente bajos en enero y febrero, alza en marzo, y así sucesivamente). No obstante, se presentan variaciones de un año a otro: los viajes aéreos en noviembre fueron notablemente bajos en 1950 y luego inusualmente altos en julio y agosto de 1958.</p>
<ol start="3" type="a">
<li><p><strong><em>Calcular un “Promedio” del Componente Estacional Dentro del Año:</em></strong> Es importante notar que, el componente estacional en el modelo (ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>)), es un patrón general que se mantiene igual de un año a otro. Es decir,<span class="math inline">\(\{s_{_t}, t=1,\ldots,12\} = \{s_{_{t+12}},t=1,\ldots,12\} =\{s_{_{t+2(12)}}, t=1,\ldots,12\}=\cdots.\)</span> El componente de ruido, <span class="math inline">\(z_{_t}\)</span>, ajusta las variaciones de un año a otro del patrón estacional general. El patrón estacional, <span class="math inline">\(s_{_t}, t=1,\ldots,12\)</span>, se estima calculando el promedio a lo largo de los años y, el componente estacional estimado, <span class="math inline">\(\hat{s}_{_t}\)</span> (el cual es el mismo para cada año), se muestra en la <a href="#fig-seasair-2" class="quarto-xref">Figura&nbsp;<span>5.9 (b)</span></a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>seas.logair.numeric<span class="ot">=</span><span class="fu">as.numeric</span>(seas.logair)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>seas.logair.matrix<span class="ot">=</span><span class="fu">matrix</span>(seas.logair.numeric,<span class="at">ncol=</span><span class="dv">12</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>seas.logair.matrix.t<span class="ot">=</span><span class="fu">t</span>(seas.logair.matrix)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>months<span class="ot">=</span><span class="fu">colMeans</span>(seas.logair.matrix.t, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(months,<span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.0867 -0.1153  0.0172 -0.0139 -0.0098  0.1145  0.2100  0.2036  0.0640
[10] -0.0761 -0.2167 -0.1012</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>seas.means<span class="ot">=</span><span class="fu">rep</span>(months,<span class="dv">12</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>seas.means<span class="ot">=</span><span class="fu">ts</span>(seas.means,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
<li><p><strong><em>Encontrar el componente de ruido restante:</em></strong> El ruido estimado en la ecuación (<a href="#eq-addecompose" class="quarto-xref"><span>5.18</span></a>), <span class="math inline">\(\hat{z_{_t}}\)</span>, es calculado de la siguiente manera</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>logair.noise <span class="ot">=</span> logAirPassengers <span class="sc">-</span> logair.sm12 <span class="sc">-</span> seas.means</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">decompose</span>(logAirPassengers))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-descadd" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-descadd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-descadd-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-descadd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.10: Descomposición aditiva de LogAirPassengers.
</figcaption>
</figure>
</div>
</div>
</div></li>
</ol>
<p>La <a href="#fig-descadd" class="quarto-xref">Figura&nbsp;<span>5.10</span></a> muestra un gráfico de los datos de LogAirPassengers junto con las partes del procedimiento de descomposición.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="descomposición-multiplicativa" class="level4" data-number="5.2.1.2">
<h4 data-number="5.2.1.2" class="anchored" data-anchor-id="descomposición-multiplicativa"><span class="header-section-number">5.2.1.2</span> Descomposición multiplicativa</h4>
<div style="text-align: justify">
<p>Se llevará a cabo en el <a href="#exm-mulair" class="quarto-xref">Ejemplo&nbsp;<span>5.6</span></a> una descomposición multiplicativa de los datos de AirPassengers. Se destaca que esta serie temporal exhibe un patrón estacional y una variabilidad intra-anual crecientes con el tiempo. A pesar de la posibilidad de modelar estos datos mediante el uso del logaritmo seguido de un modelo aditivo, en esta sección se opta por un enfoque multiplicativo para analizar los datos originales de AirPassengers. Al emplear la descomposición multiplicativa en el análisis de datos, se hace la suposición de que la serie temporal es el resultado de componentes estacionales, de tendencia y de ruido. El modelo estimado se expresa como;</p>
<p><span id="eq-muldecom"><span class="math display">\[
x_{_t}=\hat{s_{_t}}\times \hat{tr_{_t}}\times \hat{z_{_t}}.
\tag{5.19}\]</span></span></p>
<div id="exm-mulair" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 5.6</strong></span> &nbsp;</p>
<div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Descomposición multiplicativa de AirPassengers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p><strong><em>Estimar el Componente de Tendencia</em></strong>: Al igual que con el modelo aditivo, el primer paso consiste en utilizar un suavizador de media móvil centrada, nuevamente en este caso de orden 12. Anteriormente se calculó y representó gráficamente el suavizador de media móvil en la <a href="#fig-smap" class="quarto-xref">Figura&nbsp;<span>5.11</span></a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>AirPass.sm12<span class="ot">=</span><span class="fu">ma.smooth.wge</span>(AirPassengers,<span class="at">order=</span><span class="dv">12</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>AirPass.sm12<span class="ot">=</span><span class="fu">ts</span>(AirPass.sm12<span class="sc">$</span>smooth,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-smap" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-smap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-smap-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.11: Datos de pasajeros aéreos con suavizado de orden 12.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Es importante recordar que, en relación con el modelo estimado en la ecuación (<a href="#eq-muldecom" class="quarto-xref"><span>5.19</span></a>), <span class="math inline">\(\hat{tr_{_t}} =\)</span> <strong>AirPass.sm12</strong>. Esta curva casi lineal se muestra como parte de la descomposición completa en la <a href="#fig-descmul" class="quarto-xref">Figura&nbsp;<span>5.13</span></a>.</p></li>
<li><p><strong><em>Eliminar el Componente de Tendencia de los Datos:</em></strong> El siguiente paso consiste en eliminar el componente de tendencia estimado del conjunto de datos de AirPassengers. Esto se puede lograr mediante la división (en lugar de la resta).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>seas.AirPass<span class="ot">=</span>AirPassengers<span class="sc">/</span>AirPass.sm12</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La conducta estacional de un año a otro resulta mucho más clara en la <a href="#fig-seasmul-1" class="quarto-xref">Figura&nbsp;<span>5.12 (a)</span></a> después de eliminar la “interferencia” de la tendencia y el aumento de la variabilidad dentro del año. También se observa que la variabilidad dentro del año no está aumentando tanto como en la <a href="#fig-airpass" class="quarto-xref">Figura&nbsp;<span>5.3</span></a>. El incremento en la variabilidad en el modelo final (ecuación (<a href="#eq-muldecom" class="quarto-xref"><span>5.19</span></a>)) se debe a la tendencia creciente que se multiplica por los datos estacionales en la <a href="#fig-seasmul-1" class="quarto-xref">Figura&nbsp;<span>5.12 (a)</span></a>. Los patrones estacionales en la <a href="#fig-seasmul-1" class="quarto-xref">Figura&nbsp;<span>5.12 (a)</span></a> son similares a los de los datos aditivos mostrados en la <a href="#fig-seasair-1" class="quarto-xref">Figura&nbsp;<span>5.9 (a)</span></a>.</p></li>
</ol>
<div id="fig-seasmul" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-seasmul" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-seasmul-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-seasmul-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-seasmul-1.png" class="img-fluid figure-img" data-ref-parent="fig-seasmul" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-seasmul-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) AirPassengers Datos/tendencia
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-seasmul" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-seasmul-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-seasmul-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-seasmul-2.png" class="img-fluid figure-img" data-ref-parent="fig-seasmul" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-seasmul-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Componente estacional estimado
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.12: Datos de AirPassengers sin el componente de tendencia y componente estacional estimado.
</figcaption>
</figure>
</div>
<ol start="3" type="a">
<li><p><strong><em>Calcular un “Promedio” del Componente Estacional Dentro del Año:</em></strong> Al igual que en el modelo aditivo, en el modelo <a href="#eq-mulseas" class="quarto-xref"><span>5.17</span></a>, el componente estacional es un patrón general que se supone igual de un año a otro, y el componente de ruido, <span class="math inline">\(z_{_t}\)</span>, se ajusta a las variaciones de un año a otro con respecto al patrón estacional general. El componente estacional estimado, <span class="math inline">\(\hat{s_{_t}}\)</span> (que es idéntico para cada año), se representa en la <a href="#fig-seasmul-2" class="quarto-xref">Figura&nbsp;<span>5.12 (b)</span></a>. Se observa la similitud entre la <a href="#fig-seasmul-2" class="quarto-xref">Figura&nbsp;<span>5.12 (b)</span></a> y la <a href="#fig-seasair-2" class="quarto-xref">Figura&nbsp;<span>5.9 (b)</span></a>, que fue el componente estacional para la descomposición aditiva de los datos logAirPassengers.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>seas.AirPass.numeric<span class="ot">=</span><span class="fu">as.numeric</span>(seas.AirPass) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>seas.AirPass.matrix<span class="ot">=</span><span class="fu">matrix</span>(seas.AirPass.numeric,<span class="at">ncol=</span><span class="dv">12</span>) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>seas.AirPass.matrix.t<span class="ot">=</span><span class="fu">t</span>(seas.AirPass.matrix) </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>months<span class="ot">=</span><span class="fu">colMeans</span>(seas.AirPass.matrix.t,<span class="at">na.rm=</span><span class="cn">TRUE</span>) </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>seas.means<span class="ot">=</span><span class="fu">rep</span>(months,<span class="dv">12</span>) </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>seas.means<span class="ot">=</span><span class="fu">ts</span>(seas.means,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
<li><p><strong><em>Encontrar el componente de ruido restante:</em></strong> El ruido estimado en la ecuación (<a href="#eq-muldecom" class="quarto-xref"><span>5.19</span></a>), <span class="math inline">\(\hat{z_{_t}}\)</span>, es calculado de la siguiente manera</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Air.Pass.noise <span class="ot">=</span> AirPassengers <span class="sc">/</span> (AirPass.sm12 <span class="sc">*</span> seas.mean)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">decompose</span>(AirPassengers))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-descmul" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-descmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-descmul-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-descmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.13: Descomposición multiplicativa de AirPassengers.
</figcaption>
</figure>
</div>
</div>
</div></li>
</ol>
<p>La <a href="#fig-descmul" class="quarto-xref">Figura&nbsp;<span>5.13</span></a> muestra un gráfico de los datos de AirPassengers junto con las partes del procedimiento de descomposición.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="ajuste-estacional" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="ajuste-estacional"><span class="header-section-number">5.2.2</span> Ajuste estacional</h3>
<section id="ajuste-estacional-aditivo" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="ajuste-estacional-aditivo"><span class="header-section-number">5.2.2.1</span> Ajuste estacional aditivo</h4>
<div style="text-align: justify">
<p>Los ajustes estacionales están relacionados con las descomposiciones discutidas previamente. Si una descomposición aditiva es apropiada, entonces se utiliza un ajuste estacional aditivo. Un emparejamiento similar se aplica en el caso multiplicativo. El método de ajuste estacional aditivo más directo, consiste en obtener los datos ajustados estacionalmente, <span class="math inline">\(\hat{sa_{_t}}\)</span>, utilizando la fórmula</p>
<p><span id="eq-AEadd"><span class="math display">\[
\hat{sa_{_t}}=x_{_t}-\hat{s_{_t}},
\tag{5.20}\]</span></span></p>
<p>que resta el componente estacional (mostrado en la <a href="#fig-seasair-2" class="quarto-xref">Figura&nbsp;<span>5.9 (b)</span></a>) de los datos.</p>
</div>
</section>
<section id="ajuste-estacional-multiplicativo" class="level4" data-number="5.2.2.2">
<h4 data-number="5.2.2.2" class="anchored" data-anchor-id="ajuste-estacional-multiplicativo"><span class="header-section-number">5.2.2.2</span> Ajuste estacional multiplicativo</h4>
<div style="text-align: justify">
<p>Dado que la descomposición multiplicativa fue apropiada para los datos de pasajeros aéreos, se empleará un ajuste estacional multiplicativo para este conjunto de datos. Similar al método utilizado para el ajuste estacional aditivo, los datos ajustados estacionalmente utilizan la fórmula</p>
<p><span id="eq-AEMul"><span class="math display">\[
\hat{sa_{_t}}=x_{_t}/\hat{s_{_t}},
\tag{5.21}\]</span></span></p>
<p>para dividir los datos por el componente estacional (mostrado en la <a href="#fig-seasmul-2" class="quarto-xref">Figura&nbsp;<span>5.12 (b)</span></a>).</p>
<div id="exm-aeair" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 5.7</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
AirPassengers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La <a href="#fig-AEmul-1" class="quarto-xref">Figura&nbsp;<span>5.14 (a)</span></a> muestra los datos de Pasajeros Aéreos superpuestos con la estimación de tendencia obtenida utilizando un suavizador de media móvil centrada de orden 12. La <a href="#fig-AEmul-2" class="quarto-xref">Figura&nbsp;<span>5.14 (b)</span></a> es una representación gráfica de los datos ajustados estacionalmente calculados utilizando la ecuación (<a href="#eq-AEMul" class="quarto-xref"><span>5.21</span></a>). Es decir, es una representación de <strong>AirPassengers.adj</strong>. Una vez más, los datos ajustados estacionalmente son similares a la tendencia estimada pero con más detalle respecto a los cambios mensuales.</p>
<p>El análisis de la <a href="#fig-AEmul-3" class="quarto-xref">Figura&nbsp;<span>5.14 (c)</span></a> muestra que, el ajuste estacional utilizando <strong>seas,</strong> es más suave y se ve menos afectado por el aumento de la variabilidad dentro del año en años posteriores. En general, los resultados son similares a los vistos en la <a href="#fig-AEmul-2" class="quarto-xref">Figura&nbsp;<span>5.14 (b)</span></a> con los efectos estacionales eliminados.</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>AirPassengers.adj <span class="ot">=</span> AirPassengers<span class="sc">/</span>seas.means</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seasonal) </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>AirPass.sm12<span class="ot">=</span><span class="fu">ma.smooth.wge</span>(AirPassengers,<span class="at">order=</span><span class="dv">12</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>AirPass.sm12<span class="ot">=</span><span class="fu">ts</span>(AirPass.sm12<span class="sc">$</span>smooth,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>census<span class="ot">=</span><span class="fu">seas</span>(AirPassengers)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers.adj)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(census<span class="sc">$</span>data[,<span class="dv">3</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-AEmul" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AEmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-AEmul" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-AEmul-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-AEmul-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-AEmul-1.png" class="img-fluid figure-img" data-ref-parent="fig-AEmul" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-AEmul-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) AirPassengers con suavizamiento
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-AEmul" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-AEmul-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-AEmul-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-AEmul-2.png" class="img-fluid figure-img" data-ref-parent="fig-AEmul" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-AEmul-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Ajuste estacional usando la fórmula
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-AEmul" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-AEmul-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-AEmul-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-AEmul-3.png" class="img-fluid figure-img" data-ref-parent="fig-AEmul" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-AEmul-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Ajuste estacional: Census
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AEmul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.14: Datos de AirPassengers y ajuste estacional multiplicativo.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="pronóstico-y-métodos-predictivos." class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="pronóstico-y-métodos-predictivos."><span class="header-section-number">5.3</span> Pronóstico y métodos predictivos.</h2>
<div style="text-align: justify">
<p>Una aplicación principal del análisis de series temporales es la de realizar pronósticos. Anteriormente se mencionó que uno de los propósitos del suavizado es prever valores futuros. De hecho, si existe evidencia de que los patrones previos en un conjunto de datos continuarán en el futuro, se pueden utilizar diversas técnicas para realizar pronósticos.</p>
<p>Por ejemplo, un propietario de negocio puede desear prever la demanda futura de cierto producto para asegurarse de tener la cantidad apropiada de inventario en stock. Una ciudad que toma decisiones sobre infraestructura podría necesitar prever su población en diez años. Un problema difícil pero de interés para muchos en el sector financiero (y para la mayoría de las personas, en realidad) es predecir las fluctuaciones del mercado de valores y de las acciones individuales para que se puedan tomar decisiones de inversión sólidas. Cada uno de estos ejemplos ilustra la aplicabilidad y necesidad de técnicas de pronóstico. Sin una opción mejor, dichos pronósticos a menudo se hacen de manera algo subjetiva, basados en la memoria pasada de eventos similares, rumores o tal vez mediante cálculos intuitivos pero presumidos que proporcionan conjeturas educadas y estimaciones.</p>
<p>Afortunadamente, las técnicas de análisis de series temporales proporcionan una alternativa matemática basada en si las suposiciones matemáticas subyacentes son apropiadas. Esto resulta en algoritmos que calculan pronósticos junto con límites de predicción correspondientes a un determinado nivel de confianza, análogos al cálculo de la media muestral más o menos un margen de error en el entorno de muestra aleatoria no temporal. El escenario típico es que se desarrolle un algoritmo de pronóstico que luego se utilice para predecir un resultado de interés. El pronóstico comprende estimaciones de parámetros que pueden encontrarse utilizando software en un esfuerzo por lograr una capacidad predictiva óptima.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Observación</em>. </span>Se utilizarán los términos predicción y pronóstico de manera sinónima.</p>
</div>
</div>
<section id="suavizador-de-media-móvil-predictivo" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="suavizador-de-media-móvil-predictivo"><span class="header-section-number">5.3.1</span> Suavizador de media móvil predictivo</h3>
<div style="text-align: justify">
<p>En la <a href="#sec-mas" class="quarto-xref"><span>Sección 5.1.3.1</span></a> se explicó cómo se utiliza el suavizador de media móvil centrada para visualizar una versión suavizada de los datos con el propósito de recuperar señales subyacentes o eliminar ruido o efectos estacionales. También se pueden emplear medias móviles para la predicción. En lugar de la media móvil centrada, discutida en la sección mencionada, se utilizará el promedio móvil predictivo para prever valores futuros. Si los datos no exhiben estacionalidad o tendencia, entonces para predecir el valor de la serie temporal en el instante <span class="math inline">\(t+1\)</span>, tiene sentido ‘predecir’ <span class="math inline">\(x_{_{t+1}}\)</span> como el promedio de los <span class="math inline">\(k\)</span> valores de datos anteriores para algún <span class="math inline">\(k\)</span>. Es decir, dejando que <span class="math inline">\(\tilde{x}_{_{t+1}}\)</span> denote la predicción de un paso hacia adelante de <span class="math inline">\(x_{_{t+1}}\)</span> dada la información hasta el tiempo <span class="math inline">\(t\)</span>, entonces un predictor razonable y muy simple sería</p>
<p><span class="math display">\[
\tilde{x}_{_{t+1}}=\left(\sum\limits_{i=0}^{k+1}x_{_{t-i}}\right)/k.
\]</span></p>
<p>Esto es, el predictor de <span class="math inline">\(x_{_{t+1}}\)</span> es el promedio de los últimos <span class="math inline">\(k\)</span> valores de datos.</p>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="text-align: justify">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Si se usa un predictor de promedio móvil de 3 puntos para un conjunto de datos de longitud <span class="math inline">\(t=20\)</span>, se observa que la predicción un paso hacia adelante de <span class="math inline">\(x_4\)</span> usando este predictor sería</p>
<p><span class="math display">\[
\tilde{x}_{_4}=(x_{_3}+x_{_2}+x_{_1})/3.
\]</span></p>
<p>Dado que, el conjunto de datos tiene 20 valores, hay un valor conocido para <span class="math inline">\(x_{_4}\)</span>, por lo que podemos comparar el predictor <span class="math inline">\(\tilde{x}_{_4}\)</span> con el valor real, <span class="math inline">\(x_{_4}\)</span>, para evaluar la precisión del predictor.</p></li>
<li><p>Para predecir los valores <span class="math inline">\(x_{_4}\)</span> hasta <span class="math inline">\(x_{_n}\)</span>, la predicción es</p>
<p><span class="math display">\[
\tilde{x}_{_n}=(x_{_{n-1}}+x_{_{n-2}}+x_{_{n-3}})/3.
\]</span></p>
<p>Nuevamente, todos estos predictores de un paso hacia adelante pueden compararse con los valores reales para determinar la calidad de cada predicción.</p></li>
<li><p>La predicción de <span class="math inline">\(x_{_{n+1}}\)</span> está dado por</p>
<p><span class="math display">\[
\tilde{x}_{_{n+1}}= (x_{_n}+x_{_{n-1}}+x_{_{n-2}})/3.
\]</span></p>
<p>En este caso, <span class="math inline">\(\tilde{x}_{_{n+1}}\)</span> es un predictor de un valor futuro que presumiblemente no se conoce. Se puede hacer una evaluación sobre la calidad de esta predicción basándose en las predicciones de <span class="math inline">\(x_{_4},x_{_5},\ldots,\)</span> todas las cuales pueden ser verificadas. El procedimiento se ilustra en el <a href="#exm-ppm" class="quarto-xref">Ejemplo&nbsp;<span>5.8</span></a>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="suavizado-exponencial" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="suavizado-exponencial"><span class="header-section-number">5.3.2</span> Suavizado exponencial</h3>
<div style="text-align: justify">
<p>Si bien la predicción mediante el promedio móvil es fácil de conceptualizar y calcular, resulta poco realista asumir que todos los valores de datos precedentes tendrán una influencia igual en los valores futuros. Resulta más intuitivo pensar que, en muchos casos, los datos más recientes deberían tener mayor influencia en los valores futuros que los datos en un pasado más distante, ya que son más representativos del estado actual de la realidad. Un método de suavizado que tiene en cuenta esto se conoce como <em>suavizado exponencial</em>. El suavizado exponencial fue introducido por primera vez por R.G. <span class="citation" data-cites="brown1956exponential">Brown (<a href="references.html#ref-brown1956exponential" role="doc-biblioref">1956</a>)</span>. Nuevamente se considera que cada valor de datos <span class="math inline">\(x_{_t}\)</span> en una serie temporal está compuesto por un valor medio en cada punto de tiempo <span class="math inline">\(t\)</span> y un término de error independiente con media cero y varianza constante. Es decir, <span class="math inline">\(x_{t}=\mu_{_t}+e_{_t}\)</span>. Para <span class="math inline">\(0 \leq \alpha \leq 1\)</span>, la recursión de suavizado exponencial para <span class="math inline">\(t =1, 2, \ldots, n\)</span> es</p>
<p><span id="eq-sexpo"><span class="math display">\[
u_{_{t+1}}=\alpha x_{_t}+ (1-\alpha)u_{_t}.
\tag{5.22}\]</span></span></p>
<p>La ecuación (<a href="#eq-sexpo" class="quarto-xref"><span>5.22</span></a>) es una combinación lineal del valor actual <span class="math inline">\(x_{_t}\)</span> junto con <span class="math inline">\(u_{_t}\)</span>, que es la estimación de <span class="math inline">\(\mu_{_t}\)</span> basada en datos hasta, pero no incluyendo, el tiempo <span class="math inline">\(t\)</span>. En el momento <span class="math inline">\(t\)</span>, el promedio ponderado dado en la expresión anterior es el predictor de <span class="math inline">\(\mu_{_{t+1}}\)</span>. Nótese que la estimación <span class="math inline">\(\mu_{_t}\)</span> depende en gran medida del parámetro de suavizado <span class="math inline">\(\alpha\)</span>, que varía de <span class="math inline">\(0\)</span> a <span class="math inline">\(1\)</span>. Cuanto más cercano esté <span class="math inline">\(\alpha\)</span> a <span class="math inline">\(1\)</span>, más peso se le otorga a los datos más recientes, mientras que cuanto más cercano esté <span class="math inline">\(\alpha\)</span> a <span class="math inline">\(0\)</span>, menos peso se le otorga a los datos más recientes. Naturalmente, el valor óptimo de <span class="math inline">\(\alpha\)</span> dependerá de la aplicación particular del conjunto de datos y se puede ajustar en consecuencia. Debido a que la fórmula anterior es recursiva, cada nueva estimación <span class="math inline">\(\mu_{_t}\)</span> depende de la estimación anterior <span class="math inline">\(\mu_{_{t-1}}\)</span>, que a su vez depende de la estimación <span class="math inline">\(\mu_{_{t-2}}\)</span>, y así sucesivamente. Esta fórmula no parece ser “exponencial” de inmediato, ¿entonces cómo recibe el método su nombre? Dejando <span class="math inline">\(t = 1, 2, 3, 4,\)</span> vemos que la fórmula recursiva produce lo siguiente:</p>
<p><span class="math display">\[
\begin{split}
u_{_1} &amp;= x_{_1}\\
u_{_2} &amp;= \alpha x_{_1}+(1-\alpha)u_{_1}\\ &amp;=\alpha x_{_1}+(1-\alpha)x_{_1}\\ &amp;=x_{_1}\\
u_{_3} &amp;= \alpha x_{_2}+(1-\alpha)u_{_2}\\ &amp;=\alpha x_{_2}+(1-\alpha)x_{_1}\\
u_{_4} &amp;= \alpha x_{_3}+(1-\alpha)u_{_3}\\ &amp;=\alpha x_{_3}+(1-\alpha)[\alpha x_{_2}+(1-\alpha)x_{_1}]\\ &amp;=\alpha x_{_3} + \alpha(1-\alpha)x_{_2}+(1-\alpha)^2x_{_1}\\
u_{_5} &amp;= \alpha x_{_4}+(1-\alpha)u_{_4}\\ &amp;=\alpha x_{_4}+(1-\alpha)[\alpha x_{_3}+\alpha(1-\alpha)x_{_2}+(1-\alpha)^2x_{_1}]\\ &amp;=\alpha x_{_4} + \alpha(1-\alpha)x_{_3}+\alpha(1-\alpha)^2 x_{_2}+(1-\alpha)^3x_{_1}
\end{split}
\]</span></p>
<p>En general,</p>
<p><span id="eq-fexp"><span class="math display">\[
u_{_k}=\sum_{j=1}^{k-2}\alpha(1-\alpha)^{j-1}x_{_{k-j}}+(1-\alpha)^{k-2}x_{_1}.
\tag{5.23}\]</span></span></p>
<p>Es claro a partir de la ecuación (<a href="#eq-fexp" class="quarto-xref"><span>5.23</span></a>) que como <span class="math inline">\(\alpha\)</span> está entre cero y uno, la fórmula recursiva otorga menos peso a las observaciones anteriores y más peso a las observaciones más recientes, y que la magnitud del ponderado es exponencial.</p>
</div>
<div style="text-align: justify">
<div id="exm-ppm" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 5.8</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Predicción por promedio móvil y suavizado exponencial de AirPassengers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La <a href="#fig-PAP-1" class="quarto-xref">Figura&nbsp;<span>5.15 (a)</span></a> muestra la gráfica de los datos de AirPassengers. La función <strong><em>ma.pred.wge</em></strong> implementada en el software R, que hace parte de la librería <strong>tswge</strong>, calcula predicciones a un paso utilizando un suavizador de media móvil de quinto orden. Utilizando los datos, la función extiende las predicciones hasta <span class="math inline">\(x_{_{n+20}}\)</span>. La <a href="#fig-PAP-2" class="quarto-xref">Figura&nbsp;<span>5.15 (b)</span></a> representa tanto los datos como las predicciones.</p>
<p>La <a href="#fig-PAP-3" class="quarto-xref">Figura&nbsp;<span>5.15 (c)</span></a> muestra los valores <span class="math inline">\(u_{_t}\)</span> y exhibe pronósticos a un paso utilizando suavizado exponencial con <span class="math inline">\(\alpha = 0.4\)</span>. Los predictores resultantes son similares a los de la <a href="#fig-PAP-2" class="quarto-xref">Figura&nbsp;<span>5.15 (b)</span></a>.</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción por promedio móvil </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ma.pred.wge</span>(AirPassengers,<span class="at">order=</span><span class="dv">5</span>,<span class="at">n.ahead=</span><span class="dv">20</span>) </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción por suavizamiento exponencial </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">expsmooth.wge</span>(AirPassengers,<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">n.ahead=</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-PAP" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PAP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-PAP" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-PAP-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-PAP-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-PAP-1.png" class="img-fluid figure-img" data-ref-parent="fig-PAP" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PAP-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Datos de AirPassengers.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-PAP" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-PAP-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-PAP-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-PAP-2.png" class="img-fluid figure-img" data-ref-parent="fig-PAP" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PAP-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Predicción de AirPassengers por promedio móvil.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-PAP" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-PAP-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-PAP-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-PAP-3.png" class="img-fluid figure-img" data-ref-parent="fig-PAP" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PAP-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Predicción de AirPassengers por suavizamiento exponencial.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PAP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.15: Datos de AirPassengers, predicción por promedio móvil y suavizado exponencial.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="pronóstico-holt-winters" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="pronóstico-holt-winters"><span class="header-section-number">5.3.3</span> Pronóstico Holt-Winters</h3>
<div style="text-align: justify">
<p>El enfoque Holt-Winters es una técnica desarrollada por los economistas <span class="citation" data-cites="holt1957forecasting">Holt (<a href="references.html#ref-holt1957forecasting" role="doc-biblioref">1957</a>)</span> y <span class="citation" data-cites="winters1960forecasting">Winters (<a href="references.html#ref-winters1960forecasting" role="doc-biblioref">1960</a>)</span>.</p>
<p>Este método de predicción es una extensión del suavizado exponencial y se aplica a series temporales univariadas. El método no necesita un gran almacenamiento de datos y es simple. Es adecuado para la predicción a corto plazo y utiliza la función de máxima verosimilitud para estimar los parámetros. Existen dos modelos de Holt-Winter que utilizan modelos aditivos o multiplicativos basados en el componente estacional. Los modelos aditivos se aplican para un modelo con una tendencia lineal y con una tendencia exponencial.</p>
</div>
<section id="ecuaciones-aditivas-de-holt-winters" class="level4" data-number="5.3.3.1">
<h4 data-number="5.3.3.1" class="anchored" data-anchor-id="ecuaciones-aditivas-de-holt-winters"><span class="header-section-number">5.3.3.1</span> Ecuaciones aditivas de Holt-Winters</h4>
<div style="text-align: justify">
<p>El modelo aditivo de Holt-Winters para datos con tendencia y estacionalidad que no aumentan con el tiempo es adecuado (consulte la ecuación (<a href="#eq-addseas" class="quarto-xref"><span>5.16</span></a>)). Las fórmulas para la predicción de Holt-Winters son generalizaciones de las ecuaciones de suavizado exponencial; y las ecuaciones de Holt-Winters son las siguientes:</p>
<p><span id="eq-extexp"><span class="math display">\[
\begin{split}
u_{_t}&amp;= \alpha(x_{_t}-s_{_{t-m}})+(1-\alpha)(u_{_{t-1}}+v_{_{t-1}})\\
v_{_t}&amp;= \beta(u_{_t}-u_{_{t-1}})+(1-\beta)v_{_{t-1}}\\
s_{_t}&amp;= \gamma(x_{_t}-u_{_{t-1}})+(1-\gamma)s_{_{t-m}}
\end{split}
\tag{5.24}\]</span></span></p>
<p>Donde <span class="math inline">\(0 \le \alpha, \beta, \gamma \le 1\)</span>, y <span class="math inline">\(m\)</span> es la longitud del período (por ejemplo, la frecuencia en un archivo de series temporales). Para datos mensuales, <span class="math inline">\(m = 12\)</span>, y para datos trimestrales, <span class="math inline">\(m = 4\)</span>. Los valores <span class="math inline">\(u_{_t}\)</span> están relacionados con el suavizado exponencial simple y proporcionan una línea base. Los valores <span class="math inline">\(v_{_t}\)</span> y <span class="math inline">\(s_{_t}\)</span> se relacionan con los efectos de tendencia y estacionales, respectivamente. Para los tiempos <span class="math inline">\(t= m+1,\ldots, n\)</span>, las predicciones de un paso adelante, <span class="math inline">\(\hat{x}_{_t}\)</span>, para la media en el tiempo <span class="math inline">\(t\)</span>, se expresan como:</p>
<p><span class="math display">\[ \hat{x}_{_t}= u_{_{t-1}}+v_{_{t-1}}+s_{_{t-m}}.\]</span></p>
<p>Las predicciones para <span class="math inline">\(x_{_{n+l}}, l=1,\ldots,K\)</span> (es decir, hasta <span class="math inline">\(K\)</span> pasos más allá del final de los datos observados), se proporcionan de manera recursiva mediante:</p>
<p><span class="math display">\[
\hat{x}_{_{n+l|n}}=u_{_n}+mv_{_n}+s_{_{n+l-ml'}}.
\]</span></p>
<p>Donde <span class="math inline">\(l' =\left[ \frac{l-1}{m} \right] + 1\)</span>, con <span class="math inline">\(\left[ \frac{l-1}{m} \right]\)</span> denotando el entero mayor o igual a <span class="math inline">\(\frac{l-1}{m}\)</span>. Aquí, <span class="math inline">\(\alpha, \beta\)</span> y <span class="math inline">\(\gamma\)</span> son parámetros de suavizado, y se pueden obtener utilizando la función <strong>HoltWinters</strong> la cual parte de las funciones base que conforman al software <em>R</em>.</p>
</div>
</section>
<section id="ecuaciones-multiplicativas-de-holt-winters" class="level4" data-number="5.3.3.2">
<h4 data-number="5.3.3.2" class="anchored" data-anchor-id="ecuaciones-multiplicativas-de-holt-winters"><span class="header-section-number">5.3.3.2</span> Ecuaciones multiplicativas de Holt-Winters</h4>
<div style="text-align: justify">
<p>Como sugiere el término, las ecuaciones multiplicativas de Holt-Winters son aplicables a datos para los cuales el modelo multiplicativo (ecuación (<a href="#eq-mulseas" class="quarto-xref"><span>5.17</span></a>)) es apropiado. En este caso, las ecuaciones de Holt-Winters son:</p>
<p><span class="math display">\[
\begin{split}
u_{_t}&amp;= \alpha(x_{_t}/s_{_{t-m}})+(1-\alpha)(u_{_{t-1}}+v_{_{t-1}})\\
v_{_t}&amp;= \beta(u_{_t}-u_{_{t-1}})+(1-\beta)v_{_{t-1}}\\
s_{_t}&amp;= \gamma(x_{_t}/u_{_{t-1}})+(1-\gamma)s_{_{t-m}}
\end{split}
\]</span></p>
<p>Donde <span class="math inline">\(0 \le \alpha, \beta, \gamma \le 1\)</span>, y donde nuevamente, <span class="math inline">\(m\)</span> es la frecuencia. Las predicciones para los valores de <span class="math inline">\(x_{_t}\)</span> se expresan mediante:</p>
<p><span class="math display">\[ \hat{x}_{_t}= (u_{_{t-1}}+v_{_{t-1}})s_{_{t-m}} \]</span></p>
<p>Las predicciones para <span class="math inline">\(x_{_{n+l}}, l=1,\ldots,K\)</span> (es decir, hasta <span class="math inline">\(K\)</span> pasos más allá del final de los datos observados), se proporcionan de manera recursiva mediante:</p>
<p><span class="math display">\[
\hat{x}_{_{n+l|n}}=(u_{_n}+lv_{_n})s_{_{n+l-ml'.}}
\]</span></p>
<p>Donde <span class="math inline">\(l' =\left[ \frac{l-1}{m} \right] + 1\)</span>.</p>
</div>
<div id="exm-HWAP" class="theorem example" style="text-align: justify">
<p><span class="theorem-title"><strong>Ejemplo 5.9</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
AirPassengers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Reconsidere los datos de AirPassengers. Dado que los puntos temporales posteriores revelan magnitudes crecientes de los picos y valles cíclicos, la serie temporal es multiplicativa en lugar de aditiva. La <a href="#fig-HWAP-1" class="quarto-xref">Figura&nbsp;<span>5.16 (a)</span></a> muestra las predicciones de un paso adelante de Holt-Winters para los años 1950-1960 (superpuestas a los datos reales) dadas por la fórmula utilizando los parámetros de suavizado y coeficientes estimados anteriormente. Las predicciones de un paso adelante (línea sólida) son bastante precisas y apenas se distinguen de los datos (puntos en la línea). La <a href="#fig-HWAP-2" class="quarto-xref">Figura&nbsp;<span>5.16 (b)</span></a> muestra los datos de AirPassengers junto con las predicciones de Holt-Winters para los próximos tres años (línea punteada). Estas predicciones parecen extender con precisión el patrón precedente.</p>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2.20(a)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ap.hw<span class="ot">=</span><span class="fu">HoltWinters</span>(AirPassengers,<span class="at">seasonal=</span><span class="st">"mult"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ap.hw)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2.20(b)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ap.pred<span class="ot">=</span><span class="fu">predict</span>(ap.hw,<span class="at">n.ahead=</span><span class="dv">36</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ap.hw,ap.pred,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-HWAP" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HWAP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HWAP" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-HWAP-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-HWAP-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-HWAP-1.png" class="img-fluid figure-img" data-ref-parent="fig-HWAP" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HWAP-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Predicción de AirPassengers un paso adelante
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HWAP" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-HWAP-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-HWAP-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-HWAP-2.png" class="img-fluid figure-img" data-ref-parent="fig-HWAP" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HWAP-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Predicción por Holt-Winters de AirPassengers
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HWAP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.16: Predicción mediante Holt-Winters de los datos de AirPassengers.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="modelo-autoregresivo-ar" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="modelo-autoregresivo-ar"><span class="header-section-number">5.3.4</span> Modelo Autoregresivo (AR)</h3>
<div id="def-mARp" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.11</strong></span> Se afirma que el proceso <span class="math inline">\(X_{_t}\)</span> satisface un modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> (Autoregresivo de orden <span class="math inline">\(p\)</span>) si</p>
<p><span id="eq-ARp"><span class="math display">\[
X_{_t}=a_{_t}+\beta+\sum_{k=1}^p \phi_{_k}X_{_{t-k}},
\tag{5.25}\]</span></span></p>
<p>donde <span class="math inline">\(\phi_{_k}, k=1,\ldots,p\)</span> son constantes reales, <span class="math inline">\(\beta = \left(1-\phi_{_1}-\phi_{_2}-\cdots-\phi_{_p}\right)\mu\)</span>, <span class="math inline">\(\phi_{_p}\neq 0\)</span>, y <span class="math inline">\(a_{_t}\)</span> es un proceso de ruido blanco con media cero y varianza finita <span class="math inline">\(\sigma_{_a}^2\)</span>.</p>
</div>
<div style="text-align: justify">
<p>La fórmula en la ecuación (<a href="#eq-ARp" class="quarto-xref"><span>5.25</span></a>) indica que, el valor del proceso en el tiempo <span class="math inline">\(t\)</span>, es una combinación lineal de los <span class="math inline">\(p\)</span> valores anteriores más un componente de ruido aleatorio en <span class="math inline">\(a_{_t}\)</span>. Iniciamos nuestra discusión sobre los modelos <span class="math inline">\(\mathrm{AR}\)</span> al abordar sus propiedades, incluidas las condiciones de estacionariedad y el comportamiento de las autocorrelaciones y densidades espectrales para modelos específicos.</p>
<p>El modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> general definido en la <a href="#def-mARp" class="quarto-xref">Definición&nbsp;<span>5.11</span></a>, se asemeja a una ecuación de regresión múltiple, donde, en este caso, las “variables independientes” son los <span class="math inline">\(p\)</span> valores previos de la “variable dependiente” <span class="math inline">\(X_{_t}\)</span>. Otra forma de escribir la ecuación (<a href="#eq-ARp" class="quarto-xref"><span>5.25</span></a>), después de reorganizar los términos, es:</p>
<p><span id="eq-oarp"><span class="math display">\[
X_{_t}-\mu-\phi_{_1}(X_{_{t-1}}-\mu)-\phi_{_2}(X_{_{t-2}}-\mu)-\cdots-\phi_{_p}(X_{_{t-p}}-\mu)=a_{_t}.
\tag{5.26}\]</span></span></p>
<p>Al igual que en el caso de los modelos <span class="math inline">\(\mathrm{AR}(1)\)</span> y <span class="math inline">\(\mathrm{AR}(2)\)</span>, se expresará con frecuencia el <span class="math inline">\(\mathrm{AR}(p)\)</span> en la forma de media cero:</p>
<p><span id="eq-m0arp"><span class="math display">\[
X_{_t} -\phi_{_1}X_{_{t-1}}-\phi_{_2}X_{_{t-2}}-\cdots-\phi_{_p}X_{_{t-p}}=a_{_t}.
\tag{5.27}\]</span></span></p>
<p>Las ecuaciones (<a href="#eq-ARp" class="quarto-xref"><span>5.25</span></a>) a (<a href="#eq-m0arp" class="quarto-xref"><span>5.27</span></a>) dan la impresión de que un modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> será mucho más complicado de manejar que un modelo <span class="math inline">\(\mathrm{AR}(1)\)</span> o <span class="math inline">\(\mathrm{AR}(2)\)</span>. La comprensión de las características de los modelos <span class="math inline">\(\mathrm{AR}(1)\)</span> y <span class="math inline">\(\mathrm{AR}(2)\)</span> conduce directamente a comprender el comportamiento de un modelo <span class="math inline">\(\mathrm{AR}(p)\)</span>.</p>
</div>
<section id="hechos-sobre-el-modelo-mathrmarp" class="level5" data-number="5.3.4.0.1">
<h5 data-number="5.3.4.0.1" class="anchored" data-anchor-id="hechos-sobre-el-modelo-mathrmarp"><span class="header-section-number">5.3.4.0.1</span> Hechos sobre el modelo <span class="math inline">\(\mathrm{AR}(p)\)</span></h5>
<div style="text-align: justify">
<ol type="i">
<li><p><span class="math inline">\(\mathrm{E}[X_{_t}]=\mu\)</span>, para la forma “no nula de la media” del modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> en la (<a href="#eq-oarp" class="quarto-xref"><span>5.26</span></a>) y (<a href="#eq-m0arp" class="quarto-xref"><span>5.27</span></a>).</p></li>
<li><p>El proceso de varianza es <span class="math display">\[\sigma_{_X}^2=\gamma_{_0}=\frac{\sigma_{_a}^2}{1-\phi_{_1}\rho_{_1}-\phi_{_2}\rho_{_2}-\cdots-\phi_{_p}\rho_{_p}},\]</span></p>
<p>la cuál es contante y finita cuando <span class="math inline">\(X_{_t}\)</span> es estacionaria.</p></li>
<li><p>La autocorrelación de un proceso <span class="math inline">\(\mathrm{AR}(p)\)</span> satisface <span id="eq-autoarp"><span class="math display">\[
\rho_{_k}=\phi_{_p}+\sum_{n=1}^{p-1}\phi_{_n}\rho_{_{k-n}}.
\tag{5.28}\]</span></span></p>
<p>La ecuación (<a href="#eq-autoarp" class="quarto-xref"><span>5.28</span></a>) conduce a las ecuaciones de Yule-Walker de orden <span class="math inline">\(p\times p\)</span>: <span class="math display">\[
    \begin{split}
\rho_{_{1}} &amp;= \phi_{_1}+\phi_{_{2}} \rho_{_1} +\ldots + \phi_{_p} \rho_{_{p-1}} \\
\rho_{_{2}} &amp;= \phi_{_1}\rho_{_1}+\phi_{_{2}}  +\ldots + \phi_{_p} \rho_{_{p-2}}\\
&amp;\vdots \\
\rho_{_{p}} &amp;= \phi_{_1}\rho_{_{p-1}}+\phi_{_{2}} \rho_{_{p-2}} +\ldots + \phi_{_p}.
\end{split}
  \]</span></p>
<p>Conocer los valores de <span class="math inline">\(\phi_{_1}, \phi_{_2}, \ldots, \phi_{_p}\)</span> nos permite resolver este sistema de ecuaciones de dimensión <span class="math inline">\(p\times p\)</span> para <span class="math inline">\(\rho_{_k}\)</span>, donde <span class="math inline">\(k = 1, 2, \ldots, p\)</span>. Las autocorrelaciones basadas en el modelo, <span class="math inline">\(\rho_{_k}\)</span>, para <span class="math inline">\(k &gt; p\)</span>, se pueden calcular utilizando la recursión <span class="math inline">\(\phi_{_1} \rho_{_{k-1}} - \phi_{_2} \rho_{_{k-2}} + \ldots + \phi_{_p} \rho_{_{k-p}}\)</span>. No sorprendentemente, se utilizan funciones computacionales para realizar estos cálculos.</p></li>
<li><p>La densidad espectral de un modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> es dada por</p>
<p><span class="math display">\[
S_{_X}(f)=\frac{\sigma_{_a}^2}{\gamma_{_0}|1-\phi_{_1}e^{-2\pi i f}-\phi_{_2}e^{-4\pi i f}-\cdots-\phi_{_p}e^{-2p\pi i f}|^2}
\]</span></p></li>
</ol>
</div>
<div id="def-pac" class="theorem definition" style="text-align: justify">
<p><span class="theorem-title"><strong>Definición 5.12 (Autocorrelaciones parciales)</strong></span> Sea <span class="math inline">\(X_{_t}\)</span> un proceso estacionario con autocorrelaciones <span class="math inline">\(\rho_{_j}=j=0,1,\ldots\)</span>.</p>
<ol type="a">
<li><p>La autocorrelación parcial en rezago <span class="math inline">\(k\)</span>, denotada como <span class="math inline">\(\phi_{_{kk}}\)</span> , es la correlación entre <span class="math inline">\(X_{_t}\)</span> y <span class="math inline">\(X_{_{t+ k}}\)</span> condicional al “conocimiento” de las variables intervinientes <span class="math inline">\(X_{_{t+1}}, X_{_{t+2}}\)</span>, y <span class="math inline">\(X_{_{t+k-1}}\)</span>.</p></li>
<li><p>Considere las siguientes ecuaciones de Yule-Walker donde <span class="math inline">\(\phi_{_{kj}}\)</span> denota el coeficiente <span class="math inline">\(j-\)</span>ésimo asociado con las ecuaciones de Yule-Walker de orden <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[\begin{split} k&amp;=1\\ \rho_{_1}&amp;=\phi_{_{11}}\\ \\ k&amp;=2\\ \rho_{_1}&amp;=\phi_{_{21}}+\phi_{_{22}}\rho_{_1}\\ \rho_{_2}&amp;=\phi_{_{21}}\rho_{_1}+\phi_{_{22}}\end{split}\]</span></p>
<p>En general…</p>
<p><span class="math display">\[\begin{split}\rho_{_1}&amp;=\phi_{_{k1}}+\phi_{_{k2}}\rho_{_1}+\cdots+\phi_{_{kk}}\rho_{_{k-1}}\\\rho_{_2}&amp;=\phi_{_{k1}}\rho_{_1}+\phi_{_{k2}}+\cdots+\phi_{_{kk}}\rho_{_{k-2}}\\ \vdots\\ \rho_{_k}&amp;=\phi_{_{k1}}\rho_{_{k-1}}+\phi_{_{k2}}\rho_{_{k-2}}+\cdots+\phi_{_{kk}}\end{split}\]</span></p>
<p>La función de autocorrelación parcial se define como <span class="math inline">\(\phi_{_{kk}}, k = 1, 2,...\)</span>.</p></li>
</ol>
</div>
</section>
<section id="notación-de-operador-y-ecuación-característica-para-un-mathrmarp" class="level5" data-number="5.3.4.0.2">
<h5 data-number="5.3.4.0.2" class="anchored" data-anchor-id="notación-de-operador-y-ecuación-característica-para-un-mathrmarp"><span class="header-section-number">5.3.4.0.2</span> Notación de operador y ecuación característica para un <span class="math inline">\(\mathrm{AR}(p)\)</span></h5>
<div style="text-align: justify">
<p>El modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> en la ecuación (<a href="#eq-oarp" class="quarto-xref"><span>5.26</span></a>) puede ser escrito en notación de operador como</p>
<p><span class="math display">\[
(1-\phi_{_1}B-\phi_{_2}B^2-\cdots-\phi_{_p}B^p)(X_{_t}-\mu)=a_{_t}.
\]</span></p>
<p>También puede ser escrito utilizando la notación, <span class="math inline">\(\phi(B)(X_{t}-\mu)=a_{_t}\)</span> , donde <span class="math inline">\(\phi(B)\)</span> es el operador de orden <span class="math inline">\(p\)</span></p>
<p><span class="math display">\[
\phi(B)=1-\phi_{_1}B-\phi_{_2}B^2-\cdots-\phi_{_p}B^p.
\]</span></p>
<p>Convirtiendo el operador <span class="math inline">\(\phi(B)\)</span> en la expresión algebraica <span class="math inline">\(\phi(z)\)</span> resulta en el polinomio característico general <span class="math inline">\(\mathrm{AR}(p)\)</span></p>
<p><span class="math display">\[
\phi(z)=1-\phi_{_1}z-\phi_{_2}z^2-\cdots-\phi_{_p}z^p.
\]</span></p>
<p>La correspondiente ecuación característica <span class="math inline">\(\mathrm{AR}(p)\)</span> es</p>
<p><span class="math display">\[\phi(z) = 1 -\phi_{_1}z -\phi_{_2}z^2 - \cdots - -\phi_{_p}z^p = 0.\]</span></p>
<p>La ecuación característica tiene <span class="math inline">\(p\)</span> raíces <span class="math inline">\(r_{_1}, r_{_2} ,\ldots, r_{_p}\)</span> que son reales y/o complejas, donde las raíces complejas aparecen como pares conjugados y algunas raíces pueden ser repetidas.</p>
</div>
<div id="thm-arpest" class="theorem" style="text-align:justify">
<p><span class="theorem-title"><strong>Teorema 5.3</strong></span> Un proceso <span class="math inline">\(\mathrm{AR}(p)\)</span> es estacionario si y solo si todas las raíces de la ecuación característica son mayores que uno en valor absoluto.</p>
<div class="proof">
<p><span class="proof-title"><em>Prueba</em>. </span>Vea <span class="citation" data-cites="harvey1981econometric">Harvey (<a href="references.html#ref-harvey1981econometric" role="doc-biblioref">1981</a>)</span>.</p>
</div>
</div>
<div id="exm-ar4" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 5.10</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Un modelo <span class="math inline">\(\mathrm{AR}(4)\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Considere el modelo <span class="math inline">\(\mathrm{AR}(4)\)</span></p>
<p><span id="eq-ejar4"><span class="math display">\[
X_{_t}-0.13X_{_{t-1}}-1.4414X_{_{t-2}}+.0326X_{_{t-3}}+.8865X_{_{t-4}}=a_{_{t}}
\tag{5.29}\]</span></span></p>
<p>en el que <span class="math inline">\(\sigma_{_a}^2 = 1\)</span>. La notación del operador para este modelo es</p>
<p><span class="math display">\[ (1 - 0.13B + 1.4414B^2 - .0326B^3 + 0.8865 B^4)X_{_t}= a_{_t},\]</span></p>
<p>donde la correspondiente ecuación característica es</p>
<p><span class="math display">\[1 - 0.13z + 1.4414z^2 - .0326z^3 + 0.8865 z^4 = 0.\]</span></p>
<p>La <a href="#fig-ejar4" class="quarto-xref">Figura&nbsp;<span>5.17</span></a> representa una realización de longitud <span class="math inline">\(n = 200\)</span> del proceso descrito en la ecuación (<a href="#eq-ejar4" class="quarto-xref"><span>5.29</span></a>), junto con las autocorrelaciones muestrales asociadas y la estimación de la densidad espectral Parzen, respectivamente.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">gen.arma.wge</span>(<span class="at">n=</span><span class="dv">200</span>,<span class="at">phi=</span><span class="fu">c</span>(<span class="fl">0.1300</span>,<span class="fl">1.4414</span>,<span class="sc">-</span>.<span class="dv">0326</span>,<span class="sc">-</span>.<span class="dv">8865</span>),<span class="at">sn=</span><span class="dv">9310</span>,<span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotts.sample.wge</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ejar4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ejar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="series_files/figure-html/fig-ejar4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ejar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.17: Realización del modelo AR(4).
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="el-test-aumentado-de-dickey-fuller" class="level5" data-number="5.3.4.0.3">
<h5 data-number="5.3.4.0.3" class="anchored" data-anchor-id="el-test-aumentado-de-dickey-fuller"><span class="header-section-number">5.3.4.0.3</span> El Test Aumentado de Dickey-Fuller</h5>
<div style="text-align: justify">
<p>Este test ha estado en uso durante muchos años para probar las hipótesis:</p>
<ul>
<li><p><span class="math inline">\(H_{_0}:\)</span> el modelo contiene una raíz unitaria.</p></li>
<li><p><span class="math inline">\(H_{_a}\)</span>: el modelo no contiene una raíz unitaria (y por lo tanto es estacionario).</p></li>
</ul>
<p>Estadístico de prueba: <span class="math inline">\(\uptau\)</span></p>
<p>Región de rechazo: Rechazar <span class="math inline">\(H_{_0}\)</span> si <span class="math inline">\(\uptau &lt; d_{_\alpha}\)</span>, donde <span class="math inline">\(d_{_\alpha}\)</span> es el valor crítico de nivel <span class="math inline">\(\alpha\)</span>.</p>
<p><span class="citation" data-cites="dickey1976estimation">David Alan Dickey (<a href="references.html#ref-dickey1976estimation" role="doc-biblioref">1976</a>)</span> obtiene la distribución límite (complicada) del estadístico de prueba. Si <span class="math inline">\(\uptau \geq d_{_{.05}}\)</span>, entonces no se rechaza <span class="math inline">\(H_{_0}\)</span> y la prueba de Dickey-Fuller detecta una raíz unitaria. Nótese que, el rechazo de la hipótesis nula, lleva a la conclusión de que el proceso es estacionario. Por lo tanto, la conclusión de una raíz unitaria se basa en no rechazar la hipótesis nula. Es importante recalcar que no rechazar la hipótesis nula no implica creer que la hipótesis nula sea verdadera, sino simplemente que no hubo suficiente evidencia para rechazarla.</p>
<p>Para llevar a cabo pruebas de raíz unitaria, se empleará una implementación del test del software estadístico R. Existen diversas opciones, y se utilizará el siguiente comando que incorpora una constante pero no una tendencia en el modelo, y utiliza el criterio de información de Akaike (AIC) para seleccionar el número de rezagos. Se recomienda consultar las obras de <span class="citation" data-cites="dickey1979distribution">David A. Dickey y Fuller (<a href="references.html#ref-dickey1979distribution" role="doc-biblioref">1979</a>)</span> o <span class="citation" data-cites="fuller1995introduction">Fuller (<a href="references.html#ref-fuller1995introduction" role="doc-biblioref">1995</a>)</span> para obtener más detalles al respecto.</p>
</div>
</section>
<section id="factorización-del-polinomio-característico-de-un-mathrmarp" class="level5" data-number="5.3.4.0.4">
<h5 data-number="5.3.4.0.4" class="anchored" data-anchor-id="factorización-del-polinomio-característico-de-un-mathrmarp"><span class="header-section-number">5.3.4.0.4</span> Factorización del polinomio característico de un <span class="math inline">\(\mathrm{AR}(p)\)</span></h5>
<div style="text-align: justify">
<p>Las raíces de una ecuación cuadrática se pueden encontrar mediante el uso de la fórmula cuadrática. Sin embargo, las cosas se vuelven más complicadas para órdenes polinómicos mayores a dos. La ecuación cúbica</p>
<p><span class="math display">\[
1-2.1z+1.6z^2-.3z^3=0
\]</span></p>
<p>puede factorizarse en la forma <span class="math inline">\((1-.5z)(1-1.6z+.8z^2)\)</span>. Basándose en esta factorización, las raíces que se obtienen son <span class="math inline">\(r_{_1} = 1/.5=2\)</span>, <span class="math inline">\(r_{_2} = 1+.5i\)</span> y <span class="math inline">\(r_{_3} = 1-.5i\)</span>. Es decir, este <span class="math inline">\(\mathrm{AR}(3)\)</span> tendrá un comportamiento de primer orden asociado con <span class="math inline">\(1-.5B\)</span> (es decir, una frecuencia de cero), un comportamiento cíclico de segundo orden con una frecuencia de sistema <span class="math inline">\(f_{_0} = 0.07\)</span>, y el proceso es estacionario porque todas las raíces están fuera del círculo unitario.</p>
</div>
<div id="thm-poli" class="theorem" style="text-align: justify">
<p><span class="theorem-title"><strong>Teorema 5.4</strong></span> El polinomio de orden <span class="math inline">\(p\)</span>, <span class="math inline">\(1-\phi_{_1}z-\phi_{_2}z^2-\cdots-\phi_{_p}z^p\)</span>, siempre puede descomponerse como un producto de</p>
<ol type="i">
<li><p>Factores de primer orden (lineales) asociados con raíces reales.</p></li>
<li><p>Factores de segundo orden (cuadráticos) cuyas raíces son pares conjugados complejos.</p></li>
</ol>
</div>
</section>
<section id="tablas-de-factores-para-modelos-mathrmarp" class="level5" data-number="5.3.4.0.5">
<h5 data-number="5.3.4.0.5" class="anchored" data-anchor-id="tablas-de-factores-para-modelos-mathrmarp"><span class="header-section-number">5.3.4.0.5</span> Tablas de factores para modelos <span class="math inline">\(\mathrm{AR}(p)\)</span></h5>
<div style="text-align: justify">
<p>El <a href="#thm-poli" class="quarto-xref">Teorema&nbsp;<span>5.4</span></a> establece que, cualquier polinomio de orden <span class="math inline">\(p\)</span> puede expresarse como un producto de factores de primer orden y/o factores irreducibles de segundo orden. Comprender los factores de primer y segundo orden es la clave para comprender el modelo <span class="math inline">\(\mathrm{AR}(p)\)</span>.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<a href="#exm-ar4" class="quarto-xref">Ejemplo&nbsp;<span>5.10</span></a> (Continuación…)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Se considera de nuevo el modelo <span class="math inline">\(\mathrm{AR}(4)\)</span> descrito en la ecuación (<a href="#eq-ejar4" class="quarto-xref"><span>5.29</span></a>). La ecuación característica asociada es</p>
<p><span class="math display">\[
1-.13z-1.4414z^2+.0326z^3+.8865z^4=0.
\]</span></p>
<p>La forma factorizada (obtenida numéricamente) es</p>
<p><span class="math display">\[
(1-1.89B+.985B^2)(1+1.76B+.9B^2)=0.
\]</span></p>
<p>La tabla de factores es una herramienta muy útil para resumir rápidamente la escencia de un modelo <span class="math inline">\(\mathrm{AR}(p)\)</span> con respecto a los factores de primer y segundo orden.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tswge)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factor.wge</span>(<span class="at">phi=</span><span class="fu">c</span>(.<span class="dv">13</span>,<span class="fl">1.4414</span>,<span class="sc">-</span>.<span class="dv">0326</span>,<span class="sc">-</span>.<span class="dv">8865</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  
  
Coefficients of AR polynomial:  
0.1300 1.4414 -0.0326 -0.8865 

                           AR Factor Table 
Factor                 Roots                Abs Recip    System Freq 
1-1.8900B+0.9850B^2    0.9594+-0.3079i      0.9925       0.0494
1+1.7600B+0.9000B^2   -0.9778+-0.3938i      0.9487       0.4391
  
  </code></pre>
</div>
</div>
<p>En este caso, hay dos factores de segundo orden, <span class="math inline">\(1-1.89B+.985B^2\)</span> y <span class="math inline">\(1+1.76B+.9B^2\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="evaluación-de-la-precisión-de-los-pronósticos" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="evaluación-de-la-precisión-de-los-pronósticos"><span class="header-section-number">5.4</span> Evaluación de la precisión de los pronósticos</h2>
<div style="text-align: justify">
<p>Para obtener una cuantificación “general” de la calidad de las predicciones, se evalúa qué tan bien coinciden las predicciones (<span class="math inline">\(f_{_t}\)</span>) con los valores reales (<span class="math inline">\(y_{_t}\)</span>) en el tiempo <span class="math inline">\(t\)</span>. Afortunadamente, se han ideado métricas de error para evaluar la calidad del modelo y permitir la comparación con otras regresiones que poseen diferentes parámetros. Estas métricas son resúmenes breves pero informativos de la calidad de los datos. A continuación se presentan algunas métricas de rendimiento más comunes (<span class="citation" data-cites="segall2022biomedical">Segall y Niu (<a href="references.html#ref-segall2022biomedical" role="doc-biblioref">2022</a>)</span>).</p>
</div>
<section id="mae" class="level3" style="text-align: justify" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="mae"><span class="header-section-number">5.4.1</span> MAE</h3>
<p>El error absoluto medio (MAE) se calcula tomando el residuo para cada punto de datos, considerando únicamente el valor absoluto para minimizar el impacto de los valores atípicos en comparación con la ecuación (<a href="#eq-RMSE" class="quarto-xref"><span>5.32</span></a>). Luego, se obtiene el promedio de todos estos residuos. La ecuación formal se presenta a continuación: <span id="eq-MAE"><span class="math display">\[MAE= \frac{1}{n}\sum_{t=1}^n |y_{_t}-f_{_t}|. \tag{5.30}\]</span></span> Dado que se emplea el valor absoluto del residuo, no se indica el rendimiento inferior o superior del modelo. Cada residuo contribuye de manera equitativa al error total, y los errores más grandes tienen una mayor contribución al error general. Un MAE pequeño indica un buen rendimiento de predicción, mientras que un MAE grande sugiere que el modelo puede tener dificultades en ciertas áreas. Obtener MAE perfecta de 0 es rara, indica que el modelo es un predictor impecable.</p>
<p>Sin embargo, el uso del valor absoluto del residuo puede no ser el mejor enfoque para interpretar los datos, ya que los <em>valores atípicos</em> (es decir, los puntos de datos que se alejan significativamente de la tendencia general de los datos) pueden afectar significativamente el rendimiento del modelo. Dependiendo del tratamiento de los valores atípicos y extremos en los datos, es posible que se desee resaltar o minimizar su impacto. Como resultado, la elección de la métrica de error adecuada puede verse influida por el problema de los valores atípicos.</p>
</section>
<section id="mse" class="level3" style="text-align: justify" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="mse"><span class="header-section-number">5.4.2</span> MSE</h3>
<p>El error cuadrático medio (MSE) es similar al MAE, pero eleva al cuadrado la diferencia antes de sumarlos todos en lugar de utilizar el valor absoluto. Esta diferencia se puede observar en la siguiente ecuación: <span id="eq-MSE"><span class="math display">\[MSE=\frac{1}{n} \sum_{t=1}^n (y_{_t}-f_{_t})^2. \tag{5.31}\]</span></span> El error medio absoluto (MAE) y el error cuadrático medio (MSE) son métricas de error comúnmente utilizadas en la evaluación de modelos. Sin embargo, el MSE suele ser mayor que el MAE debido al cuadrado de la diferencia. Comparar los dos directamente no siempre es posible, y en su lugar, debemos comparar las métricas de error de nuestro modelo con las de un modelo ya conocido o que se ajuste a la serie de datos. El efecto de los valores atípicos en nuestros datos es más evidente con la presencia del término cuadrado en la ecuación MSE. Mientras que cada residuo en MAE contribuye proporcionalmente al error total, el error crece cuadráticamente en MSE. En última instancia, esto significa que los valores atípicos en nuestros datos contribuirán a un error total mucho mayor en el MSE que en el MAE. Del mismo modo, nuestro modelo se verá más penalizado por hacer predicciones que difieran mucho del valor real correspondiente.</p>
</section>
<section id="rmse" class="level3" style="text-align: justify" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="rmse"><span class="header-section-number">5.4.3</span> RMSE</h3>
<p>RMSE, o error cuadrático medio, es una medida frecuentemente utilizada para evaluar la diferencia entre los valores predichos <span class="math inline">\(f_{_t}\)</span> y los valores observados <span class="math inline">\(y_{_t}\)</span>. Su función se expresa a continuación, donde <span class="math inline">\(n\)</span> representa el número de observaciones. En comparación con el error cuadrático medio (MSE), RMSE toma la raíz cuadrada de MSE y restituye la unidad al mismo nivel que la variable dependiente. Por lo tanto, tiene la ventaja de ser interpretado directamente. En general, un valor de RMSE más bajo es preferible, y RMSE<span class="math inline">\(=0\)</span> indica un ajuste perfecto de los datos. La desventaja de RMSE es su sensibilidad a valores atípicos, ya que unos pocos errores grandes en la suma pueden generar un aumento significativo, y la prueba no distingue entre subestimación y sobreestimación. Como se discutió anteriormente en la descripción de los datos, el conjunto de datos que se utiliza tiene varios valores extremos de gastos elevados, por lo que utilizar solo RMSE como medida podría no ser muy adecuado.</p>
<p>La fórmula para el cálculo de RMSE es la siguiente: <span id="eq-RMSE"><span class="math display">\[RMSE= \sqrt{\frac{\sum_{t=1}^n (y_t-f_t)^2}{n}}. \tag{5.32}\]</span></span></p>
</section>
<section id="mape" class="level3" style="text-align: justify" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="mape"><span class="header-section-number">5.4.4</span> MAPE</h3>
<p>El error porcentual absoluto medio (MAPE) mide la precisión de la predicción como un porcentaje y se define generalmente de la siguiente manera. <span id="eq-MAPE"><span class="math display">\[MAPE=\frac{100}{n}\sum_{t=1}^n \left| \frac{y_t-f_t}{y_t}\right|. \tag{5.33}\]</span></span></p>
<p>La ventaja es que es muy intuitivo interpretar el error relativo, y un MAPE más bajo significa un error menor. MAPE es similar a MAE, pero normaliza MAE mediante observaciones reales, resolviendo así el problema de que MAE proporciona poca información sobre el error al comparar datos de diferentes escalas. Sin embargo, también presenta la desventaja de que puede producir valores infinitos o indefinidos para valores reales cercanos o iguales a cero. Otra limitación de MAPE es que penaliza más los errores negativos que los errores positivos. Por ejemplo, para un valor real de <span class="math inline">\(100\)</span> y un valor estimado de <span class="math inline">\(90\)</span>, el MAPE es <span class="math inline">\(0.10\)</span>. Para el mismo valor estimado y un valor real de <span class="math inline">\(80\)</span>, el MAPE es <span class="math inline">\(0.125\)</span>. Como resultado, si se utiliza MAPE como función objetivo, el estimador preferirá valores más pequeños y puede sesgarse hacia errores negativos.</p>
</section>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-brown1956exponential" class="csl-entry" role="listitem">
Brown, R. G. 1956. <em>Exponential Smoothing for Predicting Demand</em>. Little. <a href="https://books.google.com.mx/books?id=Eo_rMgEACAAJ">https://books.google.com.mx/books?id=Eo_rMgEACAAJ</a>.
</div>
<div id="ref-dickey1979distribution" class="csl-entry" role="listitem">
Dickey, David A, y Wayne A Fuller. 1979. <span>«Distribution of the estimators for autoregressive time series with a unit root»</span>. <em>Journal of the American statistical association</em> 74 (366a): 427-31.
</div>
<div id="ref-dickey1976estimation" class="csl-entry" role="listitem">
Dickey, David Alan. 1976. <em>Estimation and Hypothesis Testing in Nonstationary Time Series.</em> Iowa State University.
</div>
<div id="ref-fuller1995introduction" class="csl-entry" role="listitem">
Fuller, W. A. 1995. <em>Introduction to Statistical Time Series</em>. Wiley Series en Probability y Statistics. Wiley. <a href="https://books.google.com.mx/books?id=wyRhjmAPQIYC">https://books.google.com.mx/books?id=wyRhjmAPQIYC</a>.
</div>
<div id="ref-harvey1981econometric" class="csl-entry" role="listitem">
Harvey, AC. 1981. <span>«The econometric analysis of time series. Philip Allan»</span>. Oxford.
</div>
<div id="ref-holt1957forecasting" class="csl-entry" role="listitem">
Holt, Charles C. 1957. <span>«Forecasting trends and seasonals by exponentially weighted moving averages»</span>. <em>ONR Memorandum</em> 52 (52): 5-10.
</div>
<div id="ref-segall2022biomedical" class="csl-entry" role="listitem">
Segall, R. S., y G. Niu. 2022. <em>Biomedical and Business Applications Using Artificial Neural Networks and Machine Learning</em>. Advances en Computational Intelligence y Robotics. IGI Global. <a href="https://books.google.com.mx/books?id=9G9bEAAAQBAJ">https://books.google.com.mx/books?id=9G9bEAAAQBAJ</a>.
</div>
<div id="ref-waldmeier1961sunspot" class="csl-entry" role="listitem">
Waldmeier, Max. 1961. <span>«The sunspot-activity in the years 1610-1960»</span>. <em>Zurich: Schulthess</em>.
</div>
<div id="ref-wiener1949extrapolation" class="csl-entry" role="listitem">
Wiener, Norbert. 1949. <em>Extrapolation, interpolation, and smoothing of stationary time series: with engineering applications</em>. The MIT press.
</div>
<div id="ref-winters1960forecasting" class="csl-entry" role="listitem">
Winters, Peter R. 1960. <span>«Forecasting sales by exponentially weighted moving averages»</span>. <em>Management science</em> 6 (3): 324-42.
</div>
<div id="ref-woodward2022time" class="csl-entry" role="listitem">
Woodward, W. A., B. P. Sadler, y S. Robertson. 2022. <em>Time Series for Data Science: Analysis and Forecasting</em>. A Chapman &amp; Hall Book. CRC Press, Taylor &amp; Francis Group. <a href="https://books.google.com.mx/books?id=gM3gzgEACAAJ">https://books.google.com.mx/books?id=gM3gzgEACAAJ</a>.
</div>
<div id="ref-Yaglom1962introduction" class="csl-entry" role="listitem">
Yaglom, A. M. 1962. <em>An Introduction to the Theory of Stationary Random Functions</em>. Selected Russian publications en the mathematical sciences. Prentice-Hall. <a href="https://books.google.com.mx/books?id=l_JvAAAAIAAJ">https://books.google.com.mx/books?id=l_JvAAAAIAAJ</a>.
</div>
<div id="ref-yule1971method" class="csl-entry" role="listitem">
Yule, George Udny. 1971. <span>«On a method of investigating periodicities in disturbed series with special reference to Wolfer’s sunspot numbers»</span>. <em>Statistical Papers of George Udny Yule</em>, 389-420.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./procesos.html" class="pagination-link" aria-label="Procesos estocásticos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Procesos estocásticos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./redes.html" class="pagination-link" aria-label="Redes Neuronales">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Redes Neuronales</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Jennlg/Tesis/edit/main/series.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Jennlg/Tesis/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/Jennlg/Tesis/blob/main/series.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></div></div></footer></body></html>